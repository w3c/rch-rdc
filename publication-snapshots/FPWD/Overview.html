<!DOCTYPE html><html lang="en"><head>
<meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 32.3.0">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>



<title>RDF Dataset Canonicalization</title>

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>




<style>

  .hl-bold { font-weight: bold; color: #0a3; }
  .comment { color: #999; }
  table, thead, tr, td { padding: 5px; border-width: 1px; border-spacing: 0px; border-style: solid; border-collapse: collapse; }
  .algorithm ol {
    counter-reset: numsection;
    list-style-type: none;
  }
  .algorithm ol>li {
    margin: 0.5em 0;
  }
  .algorithm ol>li:before {
    font-weight: bold;
    counter-increment: numsection;
    content: counters(numsection, ".") ") ";
  }
  a.externalDFN {border-bottom:  1px solid #99c; font-style: italic;}

  code {
    color:#c63501
  }

</style>

<meta name="description" content="RDF [RDF11-CONCEPTS] describes a graph-based data model for making claims
    about the world and provides the foundation for reasoning upon that graph
    of information. At times, it becomes necessary to compare the differences
    between sets of graphs, digitally sign them, or generate short identifiers
    for graphs via hashing algorithms. This document outlines an algorithm for
    normalizing RDF datasets such that these operations can be
    performed.">
<link rel="canonical" href="https://www.w3.org/TR/rdf-canon/">
<script type="application/ld+json">{
  "@context": [
    "http://schema.org",
    {
      "@vocab": "http://schema.org/",
      "@language": "en",
      "w3p": "http://www.w3.org/2001/02pd/rec54#",
      "foaf": "http://xmlns.com/foaf/0.1/",
      "datePublished": {
        "@type": "http://www.w3.org/2001/XMLSchema#date"
      },
      "inLanguage": {
        "@language": null
      },
      "isBasedOn": {
        "@type": "@id"
      },
      "license": {
        "@type": "@id"
      }
    }
  ],
  "id": "https://www.w3.org/TR/rdf-canon/",
  "type": [
    "TechArticle"
  ],
  "name": "RDF Dataset Canonicalization",
  "inLanguage": "en",
  "license": "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document",
  "datePublished": "2022-11-17",
  "copyrightHolder": {
    "name": "World Wide Web Consortium",
    "url": "https://www.w3.org/"
  },
  "discussionUrl": "https://github.com/w3c/rdf-canon/issues/",
  "alternativeHeadline": "A Standard RDF Dataset Canonicalization Algorithm",
  "isBasedOn": "",
  "description": "RDF [RDF11-CONCEPTS] describes a graph-based data model for making claims\n    about the world and provides the foundation for reasoning upon that graph\n    of information. At times, it becomes necessary to compare the differences\n    between sets of graphs, digitally sign them, or generate short identifiers\n    for graphs via hashing algorithms. This document outlines an algorithm for\n    normalizing RDF datasets such that these operations can be\n    performed.",
  "editor": [
    {
      "type": "Person",
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/author/dlongley/",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://digitalbazaar.com/"
      }
    },
    {
      "type": "Person",
      "name": "Gregg Kellogg",
      "url": "https://greggkellogg.net/"
    },
    {
      "type": "Person",
      "name": "Dan Yamamoto",
      "url": "https://github.com/yamdan"
    }
  ],
  "contributor": [
    {
      "type": "Person",
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/author/dlongley/",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://digitalbazaar.com/"
      }
    }
  ],
  "citation": [
    {
      "id": "https://www.w3.org/TR/rdf11-mt/",
      "type": "TechArticle",
      "name": "RDF 1.1 Semantics",
      "url": "https://www.w3.org/TR/rdf11-mt/",
      "creator": [
        {
          "name": "Patrick Hayes"
        },
        {
          "name": "Peter Patel-Schneider"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/rdf11-concepts/",
      "type": "TechArticle",
      "name": "RDF 1.1 Concepts and Abstract Syntax",
      "url": "https://www.w3.org/TR/rdf11-concepts/",
      "creator": [
        {
          "name": "Richard Cyganiak"
        },
        {
          "name": "David Wood"
        },
        {
          "name": "Markus Lanthaler"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc3987",
      "type": "TechArticle",
      "name": "Internationalized Resource Identifiers (IRIs)",
      "url": "https://www.rfc-editor.org/rfc/rfc3987",
      "creator": [
        {
          "name": "M. Duerst"
        },
        {
          "name": "M. Suignard"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.unicode.org/versions/latest/",
      "type": "TechArticle",
      "name": "The Unicode Standard",
      "url": "https://www.unicode.org/versions/latest/",
      "publisher": {
        "name": "Unicode Consortium"
      }
    },
    {
      "id": "https://www.w3.org/TR/xpath-functions/",
      "type": "TechArticle",
      "name": "XQuery 1.0 and XPath 2.0 Functions and Operators (Second Edition)",
      "url": "https://www.w3.org/TR/xpath-functions/",
      "creator": [
        {
          "name": "Ashok Malhotra"
        },
        {
          "name": "Jim Melton"
        },
        {
          "name": "Norman Walsh"
        },
        {
          "name": "Michael Kay"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/n-quads/",
      "type": "TechArticle",
      "name": "RDF 1.1 N-Quads",
      "url": "https://www.w3.org/TR/n-quads/",
      "creator": [
        {
          "name": "Gavin Carothers"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc2119",
      "type": "TechArticle",
      "name": "Key words for use in RFCs to Indicate Requirement Levels",
      "url": "https://www.rfc-editor.org/rfc/rfc2119",
      "creator": [
        {
          "name": "S. Bradner"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8174",
      "type": "TechArticle",
      "name": "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words",
      "url": "https://www.rfc-editor.org/rfc/rfc8174",
      "creator": [
        {
          "name": "B. Leiba"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/community/reports/credentials/CG-FINAL-rdf-dataset-canonicalization-20221009/",
      "type": "TechArticle",
      "name": "RDF Dataset Canonicalization",
      "url": "https://www.w3.org/community/reports/credentials/CG-FINAL-rdf-dataset-canonicalization-20221009/",
      "creator": [
        {
          "name": "Dave Longley"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://aidanhogan.com/docs/rdf-canonicalisation.pdf",
      "type": "TechArticle",
      "name": "Canonical Forms for Isomorphic and Equivalent RDF Graphs: Algorithms for Leaning and Labelling Blank Nodes",
      "url": "https://aidanhogan.com/docs/rdf-canonicalisation.pdf",
      "creator": [
        {
          "name": "Aiden Hogan"
        }
      ],
      "publisher": {
        "name": "ACM Transactions on the Web"
      }
    },
    {
      "id": "https://www.w3.org/DesignIssues/Diff",
      "type": "TechArticle",
      "name": "Delta: an ontology for the distribution of differences between RDF graphs",
      "url": "https://www.w3.org/DesignIssues/Diff",
      "creator": [
        {
          "name": "Tim Berners-Leee"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://doi.org/10.1007/978-3-319-07443-6_11",
      "type": "TechArticle",
      "name": "A Framework for Iterative Signing of Graph Data on the Web",
      "url": "https://doi.org/10.1007/978-3-319-07443-6_11",
      "creator": [
        {
          "name": "Andreas Kasten"
        },
        {
          "name": "Ansgar Scherp"
        },
        {
          "name": "Peter Schauß "
        }
      ],
      "publisher": {
        "name": "ISWC 2014"
      }
    },
    {
      "id": "https://www.hpl.hp.com/techreports/2003/HPL-2003-142.pdf",
      "type": "TechArticle",
      "name": "Signing RDF Graphs",
      "url": "https://www.hpl.hp.com/techreports/2003/HPL-2003-142.pdf",
      "creator": [
        {
          "name": "Jeremy J. Carroll"
        }
      ],
      "publisher": {
        "name": "HP Laboratories Bristol"
      }
    }
  ]
}</script>
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "localBiblio": {
    "CCG-RDC-FINAL": {
      "id": "CCG-RDC-FINAL",
      "title": "RDF Dataset Canonicalization",
      "authors": [
        "Dave Longley"
      ],
      "editors": [
        "Dave Longley",
        "Manu Sporny"
      ],
      "date": "2022-10-09",
      "href": "https://www.w3.org/community/reports/credentials/CG-FINAL-rdf-dataset-canonicalization-20221009/",
      "status": "CG-FINAL",
      "publisher": "W3C"
    },
    "DesignIssues-Diff": {
      "id": "DesignIssues-Diff",
      "title": "Delta: an ontology for the distribution of differences between RDF graphs",
      "authors": [
        "Tim Berners-Leee"
      ],
      "date": "2015-09-25",
      "href": "https://www.w3.org/DesignIssues/Diff",
      "status": "unofficial",
      "publisher": "W3C"
    },
    "eswc2014Kasten": {
      "id": "eswc2014Kasten",
      "title": "A Framework for Iterative Signing of Graph Data on the Web",
      "authors": [
        "Andreas Kasten",
        "Ansgar Scherp",
        "Peter Schauß "
      ],
      "date": "2014",
      "href": "https://doi.org/10.1007/978-3-319-07443-6_11",
      "status": "unofficial",
      "publisher": "ISWC 2014"
    },
    "Hogan-Canonical-RDF": {
      "id": "Hogan-Canonical-RDF",
      "title": "Canonical Forms for Isomorphic and Equivalent RDF Graphs: Algorithms for Leaning and Labelling Blank Nodes",
      "authors": [
        "Aiden Hogan"
      ],
      "date": "2017-07-17",
      "href": "https://aidanhogan.com/docs/rdf-canonicalisation.pdf",
      "status": "unofficial",
      "publisher": "ACM Transactions on the Web"
    },
    "HPL-2003-142": {
      "id": "HPL-2003-142",
      "title": "Signing RDF Graphs",
      "authors": [
        "Jeremy J. Carroll"
      ],
      "date": "2003-07-23",
      "href": "https://www.hpl.hp.com/techreports/2003/HPL-2003-142.pdf",
      "publisher": "HP Laboratories Bristol",
      "status": "unofficial"
    }
  },
  "specStatus": "FPWD",
  "copyrightStart": "2010",
  "shortName": "rdf-canon",
  "subtitle": "A Standard RDF Dataset Canonicalization Algorithm",
  "github": "https://github.com/w3c/rdf-canon/",
  "editors": [
    {
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/author/dlongley/",
      "w3cid": "48025",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/"
    },
    {
      "name": "Gregg Kellogg",
      "url": "https://greggkellogg.net/",
      "w3cid": "44770"
    },
    {
      "name": "Dan Yamamoto",
      "url": "https://github.com/yamdan",
      "w3cid": "139477"
    }
  ],
  "formerEditors": [
    {
      "name": "Manu Sporny",
      "url": "http://manu.sporny.org/",
      "w3cid": "41758",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/",
      "note": "CG Report"
    }
  ],
  "authors": [
    {
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/author/dlongley/",
      "w3cid": "48025",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/"
    }
  ],
  "group": "rch",
  "testSuiteURI": "https://w3c.github.io/rdf-canon/tests/",
  "xref": [
    "rdf11-concepts",
    "rdf11-mt"
  ],
  "doJsonLd": true,
  "wgPublicList": "public-rch-wg@w3.org",
  "publishDate": "2022-11-17",
  "publishISODate": "2022-11-17T00:00:00.000Z",
  "generatedSubtitle": "W3C First Public Working Draft 17 November 2022"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD"></head>

<body class="h-entry" data-cite="rdf11-concepts rdf11-mt"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">RDF Dataset Canonicalization</h1> <h2 id="subtitle" class="subtitle">A Standard RDF Dataset Canonicalization Algorithm</h2>
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#FPWD">W3C First Public Working Draft</a> <time class="dt-published" datetime="2022-11-17">17 November 2022</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://www.w3.org/TR/2022/WD-rdf-canon-20221117/">https://www.w3.org/TR/2022/WD-rdf-canon-20221117/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/rdf-canon/">https://www.w3.org/TR/rdf-canon/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/rdf-canon/">https://w3c.github.io/rdf-canon/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/rdf-canon">https://www.w3.org/standards/history/rdf-canon</a>
                  </dd><dd>
                    <a href="https://github.com/w3c/rdf-canon/commits/">Commit history</a>
                  </dd>
        <dt>Test suite:</dt><dd><a href="https://w3c.github.io/rdf-canon/tests/">https://w3c.github.io/rdf-canon/tests/</a></dd>
        
        
        
        
        <dt>Editors:</dt><dd class="editor p-author h-card vcard" data-editor-id="48025">
    <a class="u-url url p-name fn" href="https://digitalbazaar.com/author/dlongley/">Dave Longley</a> (<a class="p-org org h-org" href="https://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="44770">
    <a class="u-url url p-name fn" href="https://greggkellogg.net/">Gregg Kellogg</a>
  </dd><dd class="editor p-author h-card vcard" data-editor-id="139477">
    <a class="u-url url p-name fn" href="https://github.com/yamdan">Dan Yamamoto</a>
  </dd>
        <dt>
                Former editor:
              </dt><dd class="editor p-author h-card vcard" data-editor-id="41758">
    <a class="u-url url p-name fn" href="http://manu.sporny.org/">Manu Sporny</a> (<a class="p-org org h-org" href="https://digitalbazaar.com/">Digital Bazaar</a>) (CG Report)
  </dd>
        <dt>Author:</dt><dd class="editor p-author h-card vcard" data-editor-id="48025">
    <a class="u-url url p-name fn" href="https://digitalbazaar.com/author/dlongley/">Dave Longley</a> (<a class="p-org org h-org" href="https://digitalbazaar.com/">Digital Bazaar</a>)
  </dd>
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/rdf-canon/">GitHub w3c/rdf-canon</a>
        (<a href="https://github.com/w3c/rdf-canon/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/rdf-canon/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/rdf-canon/issues/">open issues</a>)
      </dd><dd><a href="mailto:public-rch-wg@w3.org@w3.org?subject=%5Brdf-canon%5D%20YOUR%20TOPIC%20HERE">public-rch-wg@w3.org@w3.org</a> with subject line <kbd>[rdf-canon] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-rch-wg@w3.org">archives</a>)</dd>
        
        
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    ©
    2010-2022
    
    <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>,
    <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
<section id="abstract" class="introductory"><h2>Abstract</h2>
  <p>RDF [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>] describes a graph-based data model for making claims
    about the world and provides the foundation for reasoning upon that graph
    of information. At times, it becomes necessary to compare the differences
    between sets of graphs, digitally sign them, or generate short identifiers
    for graphs via hashing algorithms. This document outlines an algorithm for
    normalizing <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-1">RDF datasets</a> such that these operations can be
    performed.</p>
</section>

<section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p>
  <p>This document describes the <a href="#dfn-urdna2015" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-urdna2015-1"><abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr></a> algorithm for canonicalizing
    RDF datasets, which was the input from the
    <a href="https://www.w3.org/community/credentials/"><abbr title="World Wide Web Consortium">W3C</abbr> Credentials Community Group</a>
    published as [<cite><a class="bibref" data-link-type="biblio" href="#bib-ccg-rdc-final" title="RDF Dataset Canonicalization">CCG-RDC-FINAL</a></cite>].
    There are other canonicalization algorithms actively being considered
    by the Working Group – notably [<cite><a class="bibref" data-link-type="biblio" href="#bib-hogan-canonical-rdf" title="Canonical Forms for Isomorphic and Equivalent RDF Graphs: Algorithms for Leaning and Labelling Blank Nodes">Hogan-Canonical-RDF</a></cite>];
    future versions of this document may change accordingly.
    See <span class="issue" data-number="6">Issue 6: Compare the two algorithms, and decide on basis for our work</span>
    and <span class="issue" data-number="10">Issue 10: C14N choice criteria</span>
    for further discussion.</p>
<p>
    This document was published by the <a href="https://www.w3.org/groups/wg/rch">RDF Dataset Canonicalization and Hash Working Group</a> as
    a First Public Working Draft using the
        <a href="https://www.w3.org/2021/Process-20211102/#recs-and-notes">Recommendation track</a>. 
  </p><p>Publication as a First Public Working Draft does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/rch/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                  This document is governed by the
                  <a id="w3c_process_revision" href="https://www.w3.org/2021/Process-20211102/">2 November 2021 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#intro-uses"><bdi class="secno">1.1 </bdi>Uses of Dataset Canonicalization</a></li><li class="tocline"><a class="tocxref" href="#how-to-read"><bdi class="secno">1.2 </bdi>How to Read this Document</a></li><li class="tocline"><a class="tocxref" href="#typo-conventions"><bdi class="secno">1.3 </bdi>Typographical conventions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">2. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">3. </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#canonicalization"><bdi class="secno">4. </bdi>Canonicalization</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#canon-overview"><bdi class="secno">4.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#canon-terms"><bdi class="secno">4.2 </bdi>Canonicalization Algorithm Terms</a></li><li class="tocline"><a class="tocxref" href="#canon-state"><bdi class="secno">4.3 </bdi>Canonicalization State</a></li><li class="tocline"><a class="tocxref" href="#bn-issuer-state"><bdi class="secno">4.4 </bdi>Blank Node Identifier Issuer State</a></li><li class="tocline"><a class="tocxref" href="#canon-algorithm"><bdi class="secno">4.5 </bdi>Canonicalization Algorithm</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#canon-algo-overview"><bdi class="secno">4.5.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#canon-algo-algo"><bdi class="secno">4.5.2 </bdi>Algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#issue-identifier"><bdi class="secno">4.6 </bdi>Issue Identifier Algorithm</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#issue-identifier-algorithm"><bdi class="secno">4.6.1 </bdi>Algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#hash-1d-quads"><bdi class="secno">4.7 </bdi>Hash First Degree Quads</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#hash-1d-quads-overview"><bdi class="secno">4.7.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#hash-1d-quads-exampkes"><bdi class="secno">4.7.2 </bdi>Examples</a></li><li class="tocline"><a class="tocxref" href="#hash-1d-quads-algorithm"><bdi class="secno">4.7.3 </bdi>Algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#hash-related-blank-node"><bdi class="secno">4.8 </bdi>Hash Related Blank Node</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#hash-related-bn-overview"><bdi class="secno">4.8.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#hash-related-algorithm"><bdi class="secno">4.8.2 </bdi>Algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#hash-nd-quads"><bdi class="secno">4.9 </bdi>Hash N-Degree Quads</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#hash-nd-quads-overview"><bdi class="secno">4.9.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#hash-nd-quads-exampkes"><bdi class="secno">4.9.2 </bdi>Examples</a></li><li class="tocline"><a class="tocxref" href="#hash-nd-quads-algorithm"><bdi class="secno">4.9.3 </bdi>Algorithm</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">5. </bdi>Privacy Considerations</a></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">6. </bdi>Security Considerations</a></li><li class="tocline"><a class="tocxref" href="#use-cases"><bdi class="secno">7. </bdi>Use Cases</a></li><li class="tocline"><a class="tocxref" href="#examples"><bdi class="secno">8. </bdi>Examples</a></li><li class="tocline"><a class="tocxref" href="#urgna2021"><bdi class="secno">A. </bdi><abbr title="Universal RDF Graph Canonicalization Algorithm 2012">URGNA2012</abbr></a></li><li class="tocline"><a class="tocxref" href="#issue-summary"><bdi class="secno">B. </bdi>Issue summary</a></li><li class="tocline"><a class="tocxref" href="#ack"><bdi class="secno">C. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">D.2 </bdi>Informative references</a></li></ol></li></ol></nav>

<section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
  

  <p>When data scientists discuss canonicalization,
    they do so in the context of achieving a particular set of goals.
    Since the same information may sometimes be expressed in a variety of different ways,
    it often becomes necessary to transform each of these
    different ways into a single, standard representation.
    With a standard representation, the differences between
    two different sets of data can be easily determined,
    a cryptographically-strong hash identifier can be generated for a particular
    set of data,
    and a particular set of data may be digitally-signed for later
    verification.</p>

  <p>In particular, this specification is about normalizing
    <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-2">RDF datasets</a>, which are collections of graphs. Since
    a directed graph can express the same information in more than one
    way, it requires canonicalization to achieve the aforementioned goals
    and any others that may arise via serendipity.</p>

  <p>Most <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-3">RDF datasets</a> can be normalized fairly quickly, in terms
    of algorithmic time complexity. However, those that contain nodes that do
    not have globally unique identifiers pose a greater challenge. Normalizing
    these datasets presents the <dfn id="dfn-graph-isomorphism" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">graph isomorphism</dfn> problem, a
    problem that is believed to be difficult to solve quickly. More formally,
    it is believed to be an NP-Intermediate problem, that is, neither known to
    be solvable in polynomial time nor NP-complete. Fortunately, existing real
    world data is rarely modeled in a way that manifests this problem and new
    data can be modeled to avoid it. In fact, software systems can detect a
    problematic dataset and may choose to assume it's an attempted denial of
    service attack, rather than a real input, and abort.</p>

  <p>This document outlines an algorithm for generating a canonical
    serialization of an <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-4">RDF dataset</a> given an <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-5">RDF dataset</a> as input.
    The algorithm is called the
    <strong>Universal RDF Dataset Canonicalization Algorithm 2015</strong> or
    <a href="#dfn-urdna2015" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-urdna2015-2"><abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr></a>.</p>

  <section id="intro-uses"><div class="header-wrapper"><h3 id="x1-1-uses-of-dataset-canonicalization"><bdi class="secno">1.1 </bdi>Uses of Dataset Canonicalization</h3><a class="self-link" href="#intro-uses" aria-label="Permalink for Section 1.1"></a></div>
    
    <p>There are different use cases where graph or dataset canonicalization are important:</p>
    <ul>
      <li>Determining if one serialization is isomorphic to another.</li>
      <li>Digital signing of graphs (datasets) independent of serialization or format.</li>
      <li>Comparing two graphs (datasets) to find differences.</li>
      <li>Communicating change sets when remotely updating an <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-source">RDF source</a>.</li>
    </ul>
    <p>A canonicalization algorithm is necessary, but not necessarily sufficient, to handle many of these use cases. The use of <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-1">blank nodes</a> in RDF graphs and datasets has a long history and creates inevitable complexities. Blank nodes are used for different purposes:</p>
    <ul>
      <li>when a well known identifier for a node is not known, or the author of a document chooses not to unambiguously name that node,</li>
      <li>when a node is used to stitch together parts of a graph and the nodes themselves are not interesting (e.g., <a href="https://www.w3.org/TR/rdf11-mt/#rdf-collections">RDF Collections</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-mt" title="RDF 1.1 Semantics">RDF11-MT</a></cite>]),</li>
      <li>when someone is trying to create an intentionally difficult graph topology.</li>
    </ul>
    <p>Furthermore,
      RDF semantics dictate that deserializing an RDF document
      results in the creation of unique <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-2">blank nodes</a>,
      unless it can be determined that on each occasion,
      the <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-3">blank node</a> identifies the same resource.
      This is due to the fact that <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-1">blank node identifiers</a>
      are an aspect of a concrete RDF syntax
      and are not intended to be persistent or portable.
      Within the abstract RDF model,
      blank nodes do not have identifiers
      (although some
      <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-store">RDF store</a>
      implementations may use stable identifiers and may choose to make them portable).
      See <a href="https://www.w3.org/TR/rdf11-concepts/#section-blank-nodes">Blank Nodes</a>
      in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>] for more information.</p>

    <p>RDF does have a provision for allowing blank nodes
      to be published in an externally identifiable way through the use of
      <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-skolem-iri">Skolem IRIs</a>,
      which allow a given RDF store to replace the use of blank nodes
      in a concrete syntax with <a href="#dfn-internationalized-resource-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internationalized-resource-identifier-1">IRIs</a>,
      which then serve to repeatably identify that blank node within that particular RDF store;
      however, this is not generally useful for talking about the
      same graph in different RDF stores,
      or other concrete representations.
      In any case, a stable <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-2">blank node identifier</a> defined for one
      RDF store or serialization is arbitrary,
      and typically not relatable to the context within which it is used.</p>

    <p>This specification defines an algorithm for creating stable <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-3">blank node identifiers</a> repeatably for different serializations possibly using individualized <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-4">blank node identifiers</a> of the same RDF graph (dataset) by grounding each <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-4">blank node</a> through the nodes to which it is connected, essentially creating <em>Skolem <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-5">blank node identifiers</a></em>. As a result, a graph signature can be obtained by hashing a canonical serialization of the resulting <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-1">normalized dataset</a>, allowing for the isomorphism and digital signing use cases. As blank node identifiers can be stable even with other changes to a graph (dataset), in some cases it is possible to compute the difference between two graphs (datasets), for example if changes are made only to ground triples, or if new blank nodes are introduced which do not create an automorphic confusion with other existing blank nodes. If any information which would change the generated blank node identifier, a resulting diff might indicate a greater set of changes than actually exists.</p>

    <div class="note" id="issue-container-generatedID"><div role="heading" class="ednote-title marker" id="h-ednote" aria-level="4"><span>Editor's note</span></div><div class="">
      <p>Add descriptions for relevant historical discussions and prior art:</p>
      <dl>
        <dt>[<cite><a class="bibref" data-link-type="biblio" href="#bib-designissues-diff" title="Delta: an ontology for the distribution of differences between RDF graphs">DesignIssues-Diff</a></cite>]</dt>
        <dd>TimBL's design note on problems with Diff.</dd>
        <dt>[<cite><a class="bibref" data-link-type="biblio" href="#bib-eswc2014kasten" title="A Framework for Iterative Signing of Graph Data on the Web">eswc2014Kasten</a></cite>]</dt>
        <dd>A Framework for Iterative Signing of Graph Data on the Web.</dd>
        <dt>[<cite><a class="bibref" data-link-type="biblio" href="#bib-hogan-canonical-rdf" title="Canonical Forms for Isomorphic and Equivalent RDF Graphs: Algorithms for Leaning and Labelling Blank Nodes">Hogan-Canonical-RDF</a></cite>]</dt>
        <dd>Aiden Hogan's paper on canonicalizing RDF</dd>
        <dt>[<cite><a class="bibref" data-link-type="biblio" href="#bib-hpl-2003-142" title="Signing RDF Graphs">HPL-2003-142</a></cite>]</dt>
        <dd>Jeremy J. Carroll's paper on signing RDF graphs.</dd>
      </dl>
    </div></div>
  </section>

  <section id="how-to-read"><div class="header-wrapper"><h3 id="x1-2-how-to-read-this-document"><bdi class="secno">1.2 </bdi>How to Read this Document</h3><a class="self-link" href="#how-to-read" aria-label="Permalink for Section 1.2"></a></div>
    

    <p>This document is a detailed specification for an <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-6">RDF dataset</a>
      canonicalization algorithm. The document is primarily intended for the
      following audiences:</p>

    <ul>
      <li>Software developers that want to implement an <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-7">RDF dataset</a>
        canonicalization algorithm.</li>
      <li>Masochists.</li>
    </ul>

    <p>To understand the basics in this specification you must be familiar with
      basic RDF concepts [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>]. A working knowledge of
      <a href="https://en.wikipedia.org/wiki/Graph_theory">graph theory</a> and
      <a href="https://en.wikipedia.org/wiki/Graph_isomorphism">graph isomorphism</a>
      is also recommended.</p>
  </section>

  <section id="typo-conventions" class="informative"><div class="header-wrapper"><h3 id="x1-3-typographical-conventions"><bdi class="secno">1.3 </bdi>Typographical conventions</h3><a class="self-link" href="#typo-conventions" aria-label="Permalink for Section 1.3"></a></div><p><em>This section is non-normative.</em></p>
    
    <div><p>The following typographic conventions are used in this specification:</p>

<dl class="typography">
  <dt><code>markup</code></dt><dd>
    Markup (elements, attributes, properties),
    machine processable values (string, characters, media types),
    property names,
    and file names are in red-orange monospace font.</dd>
  <dt><var>variable</var></dt><dd>
    A variable in pseudo-code or in an algorithm description is italicized.</dd>
  <dt><dfn data-no-xref="" id="dfn-definition" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">definition</dfn></dt><dd>
    A definition of a term, to be used elsewhere in this or other specifications,
    is italicized and in bold.</dd>
  <dt><a data-lt="definition" href="#dfn-definition" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-definition-1">definition reference</a></dt><dd>
    A reference to a definition <em>in this document</em>
    is underlined and is also an active link to the definition itself. </dd>
  <dt><a data-lt="definition" href="#dfn-definition" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-definition-2"><code>markup definition reference</code></a></dt><dd>
    References to a definition <em>in this document</em>,
    when the reference itself is also a markup, is underlined,
    in a red-orange monospace font, and is also an active link to the definition itself.</dd>
  <dt><a class="externalDFN">external definition reference</a></dt><dd>
    A reference to a definition <em>in another document</em>
    is underlined and italicized, and is also an active link to the definition itself.</dd>
  <dt><a class="externalDFN"><code> markup external definition reference</code></a></dt><dd>
    A reference to a definition <em>in another document</em>,
    when the reference itself is also a markup,
    is underlined and italicized in a red-orange monospace font,
    and is also an active link to the definition itself.</dd>
  <dt><a href="">hyperlink</a></dt><dd>
    A hyperlink is underlined and in blue.</dd>
  <dt>[<a href="">reference</a>]</dt><dd>
    A document reference (normative or informative) is enclosed in square brackets
    and links to the references section.</dd>
</dl>

<div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span></div><p class="">Notes are in light green boxes with a green left border and with a "Note" header in green.
  Notes are always informative.</p></div>

<div class="example" id="example-1">
        <div class="marker">
    <a class="self-link" href="#example-1">Example<bdi> 1</bdi></a>
  </div> <pre class="nohighlight">Examples are in light khaki boxes, with khaki left border,
and with a numbered "Example" header in khaki.
Examples are always informative. The content of the example is in monospace font and may be syntax colored.

Examples may have tabbed navigation buttons
to show the results of transforming an example into other representations.

Code examples are generally given in a Turtle or TriG format for brevity,
where each line represents a single triple or quad.
Additionally, have the following implied directives:

BASE &lt;http://example.com/&gt;
PREFIX : &lt;#&gt;</pre>
      </div>
</div>
  </section>
</section>

<section id="conformance"><div class="header-wrapper"><h2 id="x2-conformance"><bdi class="secno">2. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 2."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key word <em class="rfc2119">MUST</em> in this document
        is to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>

<section id="terminology" class="normative"><div class="header-wrapper"><h2 id="x3-terminology"><bdi class="secno">3. </bdi>Terminology</h2><a class="self-link" href="#terminology" aria-label="Permalink for Section 3."></a></div>
  

  <dl>
    <dt><dfn id="dfn-string" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">string</dfn></dt><dd>
      A string is a sequence of zero or more Unicode characters.</dd>
    <dt><code>true</code> and <code>false</code></dt><dd>
      Values that are used to express one of two possible boolean states.</dd>
    <dt><dfn data-lt="internationalized resource identifier|iri|iris|IRI" id="dfn-internationalized-resource-identifier" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><abbr title="Internationalized Resource Identifier">IRI</abbr></dfn></dt>
    <dd>An <a href="#dfn-internationalized-resource-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internationalized-resource-identifier-2"><abbr title="Internationalized Resource Identifier">IRI</abbr></a> (Internationalized Resource Identifier) is a string that conforms to the syntax
      defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3987" title="Internationalized Resource Identifiers (IRIs)">RFC3987</a></cite>].</dd>
    <dt><dfn data-lt="subject|subjects" id="dfn-subject" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">subject</dfn></dt>
    <dd>A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-subject">subject</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</dd>
    <dt><dfn data-lt="predicate|predicates" id="dfn-predicate" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">predicate</dfn></dt>
    <dd>A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-predicate">predicate</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</dd>
    <dt><dfn data-lt="object|objects" id="dfn-object" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">object</dfn></dt>
    <dd>An <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-object">object</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</dd>
    <dt><dfn data-lt="rdf triple|rdf triples|triple|triples|RDF triple" id="dfn-rdf-triple" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">RDF triple</dfn></dt>
    <dd>A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-triple">triple</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</dd>
    <dt><dfn data-lt="rdf graph|rdf graphs|graph|graphs|RDF graph" id="dfn-rdf-graph" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">RDF graph</dfn></dt>
    <dd>An <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-graph">RDF graph</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</dd>
    <dt><dfn data-lt="graph name|graph names" id="dfn-graph-name" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">graph name</dfn></dt>
    <dd>A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-graph-name">graph name</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</dd>
    <dt><dfn id="dfn-default-graph" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">default graph</dfn></dt>
    <dd>The <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-default-graph">default graph</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].</dd>
    <dt><dfn data-lt="quad|quads" id="dfn-quad" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">quad</dfn></dt>
    <dd>A tuple composed of <a href="#dfn-subject" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subject-1">subject</a>, <a href="#dfn-predicate" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-predicate-1">predicate</a>, <a href="#dfn-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-object-1">object</a>, and <a href="#dfn-graph-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-graph-name-1">graph name</a>.
      This is a generalization of an <a href="#dfn-rdf-triple" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-triple-1">RDF triple</a> along with a <a href="#dfn-graph-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-graph-name-2">graph name</a>.</dd>
    <dt><dfn data-lt="rdf dataset|rdf datasets|dataset|datasets|RDF dataset" id="dfn-rdf-dataset" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">RDF dataset</dfn></dt>
    <dd>A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">dataset</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>].
      For the purposes of this specification, an <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-8">RDF dataset</a>
      is considered to be a set of <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-1">quads</a></dd>
    <dt><dfn data-lt="blank node|blank nodes" id="dfn-blank-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">blank node</dfn></dt>
    <dd>A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node">blank node</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>]. In short, it is a node in a graph that is
      neither an <a href="#dfn-internationalized-resource-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internationalized-resource-identifier-3"><abbr title="Internationalized Resource Identifier">IRI</abbr></a>, nor a
      <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-literal">literal</a>.</dd>
    <dt><dfn data-lt="blank node identifier|blank node identifiers" id="dfn-blank-node-identifier" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">blank node identifier</dfn></dt>
    <dd>A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node-identifier">blank node identifier</a>
      as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf11-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF11-CONCEPTS</a></cite>]. In short, it is a <a href="#dfn-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-string-1">string</a> that begins
      with <code>_:</code> that is used as an identifier for an
      <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-5">blank node</a>. <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-6">Blank node identifiers</a>
      are typically implementation-specific local identifiers; this document
      specifies an algorithm for deterministically specifying them.</dd>
  </dl>
</section>

<section id="canonicalization"><div class="header-wrapper"><h2 id="x4-canonicalization"><bdi class="secno">4. </bdi>Canonicalization</h2><a class="self-link" href="#canonicalization" aria-label="Permalink for Section 4."></a></div>
  

  <p>Canonicalization is the process of transforming an
    <a href="#dfn-input-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-dataset-1">input dataset</a> to a <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-2">normalized dataset</a>. That
    is, any two <a href="#dfn-input-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-dataset-2">input datasets</a> that contain the same
    information, regardless of their arrangement, will be transformed into
    identical <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-3">normalized dataset</a>. The problem requires directed
    graphs to be deterministically ordered into sets of nodes and edges. This
    is easy to do when all of the nodes have globally-unique identifiers, but
    can be difficult to do when some of the nodes do not. Any nodes without
    globally-unique identifiers must be issued deterministic identifiers.</p>

  <div class="note" id="issue-container-generatedID-1"><div role="heading" class="ednote-title marker" id="h-ednote-0" aria-level="3"><span>Editor's note</span></div><p class="">Strictly speaking, the normalized dataset must be serialized to be stable, as within a dataset, blank node identifiers have no meaning. This specification defines a <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-4">normalized dataset</a> to include stable identifiers for blank nodes, but practical uses of this will always generate a canonical serialization of such a dataset.</p></div>

  <p>In time, there may be more than one canonicalization algorithm and,
    therefore, for identification purposes, this algorithm is named the
    "Universal RDF Dataset Canonicalization Algorithm 2015"
    (<abbr title="Universal RDF Dataset Canonicalization Algorithm 2015"><dfn class="export" data-export="" id="dfn-urdna2015" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr></dfn></abbr>).</p>

  <div class="note" id="issue-container-generatedID-2"><div role="heading" class="ednote-title marker" id="h-ednote-1" aria-level="3"><span>Editor's note</span></div><p class="">This statement is overly prescriptive and does not include normative language.
    This spec should describe the theoretical basis for graph canonicalization and describe
    behavior using normative statements. The explicit algorithms should follow as an informative appendix.</p></div>

  <section id="canon-overview" class="informative"><div class="header-wrapper"><h3 id="x4-1-overview"><bdi class="secno">4.1 </bdi>Overview</h3><a class="self-link" href="#canon-overview" aria-label="Permalink for Section 4.1"></a></div><p><em>This section is non-normative.</em></p>
    

    <p>To determine a canonical labeling, <a href="#dfn-urdna2015" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-urdna2015-3"><abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr></a> considers the
      information connected to each blank node.
      Nodes with unique first degree information can immediately be issued a canonical identifier
      via the <a href="#issue-identifier">Issue Identifier algorithm</a>.
      When a node has non-unique first degree information,
      it is necessary to determine all information that is transitively connected
      to it throughout the entire dataset.
      <a href="#hash-1d-quads" class="sectionRef sec-ref"><bdi class="secno">4.7 </bdi>Hash First Degree Quads</a> defines a
      node’s first degree information via its first degree hash. </p>

    <p>Hashes are computed from the information of each blank node.
      These hashes encode the mentions incident to each blank node.
      The <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-1">hash</a> of a string <var>s</var>, is the lower-case,
      hexidecimal representation of the result of passing <var>s</var>
      through a cryptographic hash function.
      <abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr> uses the SHA-256 hash algorithm.</p>
  </section>

  <section id="canon-terms"><div class="header-wrapper"><h3 id="x4-2-canonicalization-algorithm-terms"><bdi class="secno">4.2 </bdi>Canonicalization Algorithm Terms</h3><a class="self-link" href="#canon-terms" aria-label="Permalink for Section 4.2"></a></div>
    
    <dl>
      <dt><dfn data-lt="input dataset|input datasets" id="dfn-input-dataset" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">input dataset</dfn></dt>
      <dd>The abstract <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-9">RDF dataset</a> that is provided as input to
        the algorithm.</dd>
      <dt><dfn id="dfn-normalized-dataset" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">normalized dataset</dfn></dt>
      <dd>The immutable, abstract <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-10">RDF dataset</a> and set of normalized
        <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-7">blank node identifiers</a> that are produced as output by the algorithm. A <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-5">normalized dataset</a> is a restriction on an <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-11">RDF dataset</a> where all nodes are labeled, and <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-6">blank nodes</a> are labeled with <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-8">blank node identifiers</a> consistent with running this algorithm on a base <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-12">RDF dataset</a>. A concrete serialization of an <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-6">normalized dataset</a> <em class="rfc2119">MUST</em> label all <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-7">blank nodes</a> using these stable <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-9">blank node identifiers</a>.</dd>
      <dt><dfn id="dfn-identifier-issuer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">identifier issuer</dfn></dt>
      <dd>An identifier issuer is used to issue new <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-10">blank node identifier</a>. It
        maintains a
        <a href="#bn-issuer-state">blank node identifier issuer state</a>.</dd>
      <dt><dfn id="dfn-hash" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">hash</dfn></dt>
      <dd>The lowercase, hexadecimal representation of a message digest.</dd>
      <dt><dfn id="dfn-hash-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">hash algorithm</dfn></dt>
      <dd>The hash algorithm used by <a href="#dfn-urdna2015" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-urdna2015-4"><abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr></a>, namely, SHA-256.</dd>
      <dt><dfn data-lt="code point order|code point ordered|Unicode point order" id="dfn-code-point-order" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Unicode point order</dfn></dt>
      <dd>This refers to determining the order of two Unicode strings (<code>A</code> and <code>B</code>),
        using a
        <a href="https://en.wikipedia.org/wiki/Total_order">total ordering</a>
        of [<cite><a class="bibref" data-link-type="biblio" href="#bib-unicode" title="The Unicode Standard">UNICODE</a></cite>] comparing code points.
        This is equivalent to
        using <br><code><a href="https://www.w3.org/TR/xpath-functions/#func-compare">fn:compare</a>(A, B, "http://www.w3.org/2005/xpath-functions/collation/codepoint")</code>,
        as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-xpath-functions" title="XQuery 1.0 and XPath 2.0 Functions and Operators (Second Edition)">XPATH-FUNCTIONS</a></cite>].
        <div class="issue closed" id="issue-container-number-18"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/18"><span class="issue-number">Issue 18</span></a><span class="issue-label">: Unicode ordering <a class="respec-gh-label" href="https://github.com/w3c/rdf-canon/issues/?q=is%3Aissue+is%3Aopen+label%3A%22question%22" style="background-color: rgb(216, 118, 227); color: rgb(0, 0, 0);" aria-label="GitHub label: question">question</a></span></div><p dir="auto">URDNA2015 depends on a reliable sort order for lexicographically sorting/ordering values to guarantee that quads are traversed in a predictable order. As revealed in discussions on PR <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1412326800" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/17" data-hovercard-type="pull_request" data-hovercard-url="/w3c/rdf-canon/pull/17/hovercard" href="https://github.com/w3c/rdf-canon/pull/17">#17</a> (<a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1412326800" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/17" data-hovercard-type="pull_request" data-hovercard-url="/w3c/rdf-canon/pull/17/hovercard?comment_id=1000874130&amp;comment_type=review_comment" href="https://github.com/w3c/rdf-canon/pull/17#discussion_r1000874130">#17 (comment)</a>, <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1412326800" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/17" data-hovercard-type="pull_request" data-hovercard-url="/w3c/rdf-canon/pull/17/hovercard?comment_id=1001101189&amp;comment_type=review_comment" href="https://github.com/w3c/rdf-canon/pull/17#discussion_r1001101189">#17 (comment)</a>, <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1412326800" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/17" data-hovercard-type="pull_request" data-hovercard-url="/w3c/rdf-canon/pull/17/hovercard?comment_id=1001206735&amp;comment_type=review_comment" href="https://github.com/w3c/rdf-canon/pull/17#discussion_r1001206735">#17 (comment)</a>, <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1412326800" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/17" data-hovercard-type="pull_request" data-hovercard-url="/w3c/rdf-canon/pull/17/hovercard?comment_id=1001211657&amp;comment_type=review_comment" href="https://github.com/w3c/rdf-canon/pull/17#discussion_r1001211657">#17 (comment)</a>, <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1412326800" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/17" data-hovercard-type="pull_request" data-hovercard-url="/w3c/rdf-canon/pull/17/hovercard?comment_id=1001860795&amp;comment_type=review_comment" href="https://github.com/w3c/rdf-canon/pull/17#discussion_r1001860795">#17 (comment)</a>, <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1412326800" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/17" data-hovercard-type="pull_request" data-hovercard-url="/w3c/rdf-canon/pull/17/hovercard?comment_id=1001876580&amp;comment_type=review_comment" href="https://github.com/w3c/rdf-canon/pull/17#discussion_r1001876580">#17 (comment)</a>, and <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1412326800" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/17" data-hovercard-type="pull_request" data-hovercard-url="/w3c/rdf-canon/pull/17/hovercard?comment_id=1287262278&amp;comment_type=issue_comment" href="https://github.com/w3c/rdf-canon/pull/17#issuecomment-1287262278">#17 (comment)</a>) this is a more complicated problem than it would first appear, and affects any algorithm that would be used for C14N.</p>
<p dir="auto">Our problem is somewhat simplified by N-Quads requiring UTF-8, but even so different implementations may give different results.</p>
<p dir="auto">The problem is generic enough that it must hit other specifications as well (certainly JSON-LD) and may call for an early TAG or I18N WG review.</p></div>
      </dd>
      <dt><dfn data-lt="mention|mention set" data-plurals="mentions" id="dfn-mention" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">mention set</dfn></dt>
      <dd>The set of all <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-2">quads</a> in a <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-13">dataset</a>
        that mention a node <var>n</var> is called its <a href="#dfn-mention" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-mention-1">mention set</a> of <var>n</var>,
        denoted <var>Q<sub>n</sub></var>.</dd>
      <dt><dfn data-plurals="gossip paths" id="dfn-gossip-path" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">gossip path</dfn></dt>
      <dd>The gossip path between two <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-8">blank nodes</a> contained within
        <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-3">quads</a> in a <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-14">dataset</a>, where the path is a sequence
        of nodes and quads such that the first quad includes
        the starting node as an component, and the last quad includes
        the ending node as an component with each quad in the path
        containing both the preceding and following nodes.</dd>
    </dl>
  </section>

  <section id="canon-state"><div class="header-wrapper"><h3 id="x4-3-canonicalization-state"><bdi class="secno">4.3 </bdi>Canonicalization State</h3><a class="self-link" href="#canon-state" aria-label="Permalink for Section 4.3"></a></div>
    

    <p>When performing the steps required by the canonicalization algorithm,
      it is helpful to track state in a data structure called the
      <dfn id="dfn-canonicalization-state" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">canonicalization state</dfn>. The information contained in the
      <a href="#dfn-canonicalization-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-state-1">canonicalization state</a> is described below.</p>

    <dl>
      <dt><dfn id="dfn-blank-node-to-quads-map" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">blank node to quads map</dfn></dt>
      <dd>A data structure that maps a <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-11">blank node identifier</a> to
        the <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-4">quads</a> in which they appear in the
        <a href="#dfn-input-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-dataset-3">input dataset</a>.</dd>
      <dt><dfn id="dfn-hash-to-blank-nodes-map" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">hash to blank nodes map</dfn></dt>
      <dd>A data structure that maps a <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-2">hash</a> to a list of
        <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-12">blank node identifiers</a>.</dd>
      <dt><dfn id="dfn-canonical-issuer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">canonical issuer</dfn></dt>
      <dd>An <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-1">identifier issuer</a>, initialized with the
        prefix <code>_:c14n</code>, for issuing canonical
        <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-13">blank node identifiers</a>.
        <div class="note" id="issue-container-generatedID-3"><div role="heading" class="ednote-title marker" id="h-ednote-2" aria-level="4"><span>Editor's note</span></div><div class="">
          Mapping all <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-9">blank nodes</a> to use this
          identifier spec means that an <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-15">RDF dataset</a> composed of two
          different <a href="#dfn-rdf-graph" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-graph-1">RDF graphs</a> will use different
          identifiers then that for the graphs taken independently. This may
          happen anyway, due to <a href="https://en.wikipedia.org/wiki/Automorphism">automorphisms</a>,
          or overlapping statements, but an identifier based on the resulting
          <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-3">hash</a> along with an issue sequence number specific to that <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-4">hash</a> would
          stand a better chance of surviving such minor changes, and allow the
          resulting information to be useful for <a href="https://www.w3.org/2001/sw/wiki/How_to_diff_RDF">RDF Diff</a>.
        </div></div>
      </dd>
    </dl>
  </section>

  <section id="bn-issuer-state"><div class="header-wrapper"><h3 id="x4-4-blank-node-identifier-issuer-state"><bdi class="secno">4.4 </bdi>Blank Node Identifier Issuer State</h3><a class="self-link" href="#bn-issuer-state" aria-label="Permalink for Section 4.4"></a></div>
    

    <p>During the canonicalization algorithm, it is sometimes necessary to
      issue new identifiers to <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-10">blank nodes</a>. The
      <a href="#issue-identifier">Issue Identifier algorithm</a> uses an
      <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-2">identifier issuer</a> to accomplish this task. The information
      an <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-3">identifier issuer</a> needs to keep track of is described
      below.</p>

    <dl>
      <dt><dfn id="dfn-identifier-prefix" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">identifier prefix</dfn></dt>
      <dd>The identifier prefix is a string that is used at the beginning of an
        <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-14">blank node identifier</a>. It should be initialized to a
        string that is specified by the canonicalization algorithm. When
        generating a new <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-15">blank node identifier</a>, the prefix
        is concatenated with a <a href="#dfn-identifier-counter" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-counter-1">identifier counter</a>. For example,
        <code>_:c14n</code> is a proper initial value for the
        <a href="#dfn-identifier-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-prefix-1">identifier prefix</a> that would produce
        <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-16">blank node identifiers</a> like <code>_:c14n1</code>.</dd>
      <dt><dfn id="dfn-identifier-counter" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">identifier counter</dfn></dt>
      <dd>A counter that is appended to the <a href="#dfn-identifier-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-prefix-2">identifier prefix</a> to
        create an <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-17">blank node identifier</a>. It is initialized to
        <code>0</code>.</dd>
      <dt><dfn id="dfn-issued-identifiers-list" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">issued identifiers list</dfn></dt>
      <dd>A list that tracks previously issued identifiers in the order in
        which they were issued. It also tracks the existing identifier that
        triggered the issuance, to prevent issuing more than one new identifier
        per existing identifier, and to allow <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-11">blank nodes</a> to
        be reassigned identifiers some time after issuance.</dd>
    </dl>
  </section>

  <section id="canon-algorithm" class="algorithm"><div class="header-wrapper"><h3 id="x4-5-canonicalization-algorithm"><bdi class="secno">4.5 </bdi>Canonicalization Algorithm</h3><a class="self-link" href="#canon-algorithm" aria-label="Permalink for Section 4.5"></a></div>
    
  <div class="note" id="issue-container-generatedID-4"><div role="heading" class="ednote-title marker" id="h-ednote-3" aria-level="4"><span>Editor's note</span></div><p class="">At the time of writing, there are several open issues that will determine important details of the canonicalization algorithm.</p></div>
        <div class="issue" id="issue-container-number-4"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/4"><span class="issue-number">Issue 4</span></a><span class="issue-label">: What is the output of the c14n algorithm?</span></div><p dir="auto">Following the discussion that just happened at the TPAC joint meeting with the VC.</p>
<p dir="auto">An option is to return one particular serialization.<br>
An another option is to return a mapping from bnodes to labels.</p>
<p dir="auto">I prefer the second solution as it is more generic. It does not preclude which serialization to use downstream. It actually does not impose that you serialize the dataset (imagine storing a dataset in a triple store with canonical blank node labels).</p></div>
        <div class="issue" id="issue-container-number-6"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/6"><span class="issue-number">Issue 6</span></a><span class="issue-label">: Compare the two algorithms, and decide on basis for our work</span></div><p dir="auto">At TPAC 2022, the RCH WG had a joint meeting with the VC WG, see <a href="https://www.w3.org/2017/vc/WG/Meetings/Minutes/2022-09-16-vcwg#section2" rel="nofollow">minutes</a>.</p>
<p dir="auto">During that meeting, we had two presentations about canonicalization algorithms:</p>
<ul dir="auto">
<li><a href="https://docs.google.com/presentation/d/1hrqozY2EGZ8i8y40abyEuJmIb6hCiRS-37pdj6bhBLY/edit#slide=id.g15613afc368_10_35" rel="nofollow">Presentation by Dave Longley</a>. See also <a href="https://lists.w3.org/Archives/Public/public-credentials/2021Mar/att-0220/RDFDatasetCanonicalization-2020-10-09.pdf" rel="nofollow">this paper</a>.</li>
<li><a href="https://docs.google.com/presentation/d/1hrqozY2EGZ8i8y40abyEuJmIb6hCiRS-37pdj6bhBLY/edit#slide=id.g1553dcd7b23_239_0" rel="nofollow">Presentation by Aidan Hogan</a>. See also <a href="https://aidanhogan.com/docs/rdf-canonicalisation.pdf" rel="nofollow">this paper</a>.</li>
</ul>
<p dir="auto">The first algorithm has some track record of incubation in the W3C CCG, and it has an <a href="https://w3c-ccg.github.io/rdf-dataset-canonicalization/spec/" rel="nofollow">existing specification</a>.</p>
<p dir="auto">On today's RCH WG meeting, there was a proposal to use the W3C CCG specification as a basis, but OTOH there was also a desire to compare the two algorithms to better understand how they differ, and why one might be used over the other.</p>
<p dir="auto">So this issue is an invitiation to anyone who can tell us more about the differences between the two algorithms and their potential implications.</p></div>
        <div class="issue" id="issue-container-number-7"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/7"><span class="issue-number">Issue 7</span></a><span class="issue-label">: Support generalized RDF</span></div><p dir="auto"><em>Generalized RDF</em> is described in <a href="https://www.w3.org/TR/rdf11-concepts/#section-generalized-rdf" rel="nofollow">RDF 1.1  Concepts and Abstract Syntax</a>.</p>
<p dir="auto">It removes restrictions on the type of RDF term that can occur in any slot in a quad tuple - literals as subjects or predicates, blank nodes as predicates etc. By implication, that would include RDF-start quoted triples.</p>
<p dir="auto">RDF 1.1 separately changed "RDF dataset" to allow blank nodes for in the graph slot.</p>
<p dir="auto">Generalized RDF does arise - for example, in some rules systems.</p>
<p dir="auto">Covering generalized RDF gives some future proofing.</p></div>
        <div class="issue" id="issue-container-number-8"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/8"><span class="issue-number">Issue 8</span></a><span class="issue-label">: "Herd-privacy" canonicalization</span></div><p dir="auto">I completely agree with the importance of the "herd-privacy" canonicalization proposed in <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1376301843" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/4" data-hovercard-type="issue" data-hovercard-url="/w3c/rdf-canon/issues/4/hovercard?comment_id=1262602679&amp;comment_type=issue_comment" href="https://github.com/w3c/rdf-canon/issues/4#issuecomment-1262602679">#4 (comment)</a> by <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/dlongley/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/dlongley">@dlongley</a> when we use c14n with selective disclosure. However, if I understand it correctly, we would still have to improve the above algorithm; it seems to me that the following normalized datasets CX1 and CX2 are not modified via the above transformation, i.e., CX1==CY1 and CX2==CY2.</p>
<p dir="auto">CX1 (<a href="https://json-ld.org/playground/#startTab=tab-canonized&amp;json-ld=%7B%22%40context%22%3A%5B%22https%3A%2F%2Fschema.org%2F%22%5D%2C%22name%22%3A%22Alice%22%2C%22spouse%22%3A%7B%22name%22%3A%22Bob%22%7D%7D" rel="nofollow">obtained from JSON-LD Playground</a>) (==CY1)</p>
<div class="highlight highlight-source-turtle notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="_:c14n0 <http://schema.org/name> &quot;Alice&quot; .
_:c14n0 <http://schema.org/spouse> _:c14n1 .
_:c14n1 <http://schema.org/name> &quot;Bob&quot; ."><pre aria-busy="false"><code class="hljs javascript">_:c14n0 &lt;http:<span class="hljs-comment">//schema.org/name&gt; "Alice" .</span>
_:c14n0 &lt;http:<span class="hljs-comment">//schema.org/spouse&gt; _:c14n1 .</span>
_:c14n1 &lt;http:<span class="hljs-comment">//schema.org/name&gt; "Bob" .</span></code></pre></div>
<p dir="auto">CX2 (<a href="https://json-ld.org/playground/#startTab=tab-canonized&amp;json-ld=%7B%22%40context%22%3A%5B%22https%3A%2F%2Fschema.org%2F%22%5D%2C%22name%22%3A%22Alice%22%2C%22spouse%22%3A%7B%22name%22%3A%22Carl%22%7D%7D" rel="nofollow">obtained from JSON-LD Playground</a>) (==CY2)</p>
<div class="highlight highlight-source-turtle notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="_:c14n0 <http://schema.org/name> &quot;Carl&quot; .
_:c14n1 <http://schema.org/name> &quot;Alice&quot; .
_:c14n1 <http://schema.org/spouse> _:c14n0 ."><pre aria-busy="false"><code class="hljs javascript">_:c14n0 &lt;http:<span class="hljs-comment">//schema.org/name&gt; "Carl" .</span>
_:c14n1 &lt;http:<span class="hljs-comment">//schema.org/name&gt; "Alice" .</span>
_:c14n1 &lt;http:<span class="hljs-comment">//schema.org/spouse&gt; _:c14n0 .</span></code></pre></div>
<p dir="auto">Therefore, even if Alice selectively hides the statement about her spouse, anyone can easily guess whether Bob or Carl is Alice's spouse based on the canonicalized identifiers or the order of unrevealed statement:</p>
<p dir="auto">CY1 with selective disclosure</p>
<div class="highlight highlight-source-turtle notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="_:c14n0 <http://schema.org/name> &quot;Alice&quot; .
_:c14n0 <http://schema.org/spouse> _:c14n1 .
####### 3rd statement is unrevealed ########"><pre aria-busy="false"><code class="hljs css">_:c14n0 &lt;http://schema.org/name&gt; <span class="hljs-string">"Alice"</span> .
_:c14n0 &lt;http://schema.org/spouse&gt; _:c14n1 .
###<span class="comment"> <span class="hljs-number">3</span>rd statement is unrevealed </span>####</code></pre></div>
<p dir="auto">CY2 with selective disclosure</p>
<div class="highlight highlight-source-turtle notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="####### 1st statement is unrevealed ########
_:c14n1 <http://schema.org/name> &quot;Alice&quot; .
_:c14n1 <http://schema.org/spouse> _:c14n0 ."><pre aria-busy="false"><code class="hljs css">###<span class="comment"> <span class="hljs-number">1s</span>t statement is unrevealed </span>####
_:c14n1 &lt;http://schema.org/name&gt; <span class="hljs-string">"Alice"</span> .
_:c14n1 &lt;http://schema.org/spouse&gt; _:c14n0 .</code></pre></div>
<p dir="auto">What we actually wanted seemed like the following result:</p>
<p dir="auto">CY1'</p>
<div class="highlight highlight-source-turtle notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="_:c14n0 <http://schema.org/name> &quot;Alice&quot; .
_:c14n1 <http://schema.org/name> &quot;Bob&quot; .
_:c14n0 <http://schema.org/spouse> _:c14n1 ."><pre aria-busy="false"><code class="hljs javascript">_:c14n0 &lt;http:<span class="hljs-comment">//schema.org/name&gt; "Alice" .</span>
_:c14n1 &lt;http:<span class="hljs-comment">//schema.org/name&gt; "Bob" .</span>
_:c14n0 &lt;http:<span class="hljs-comment">//schema.org/spouse&gt; _:c14n1 .</span></code></pre></div>
<p dir="auto">CY2'</p>
<div class="highlight highlight-source-turtle notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="_:c14n0 <http://schema.org/name> &quot;Alice&quot; .
_:c14n1 <http://schema.org/name> &quot;Carl&quot; .
_:c14n0 <http://schema.org/spouse> _:c14n1 ."><pre aria-busy="false"><code class="hljs javascript">_:c14n0 &lt;http:<span class="hljs-comment">//schema.org/name&gt; "Alice" .</span>
_:c14n1 &lt;http:<span class="hljs-comment">//schema.org/name&gt; "Carl" .</span>
_:c14n0 &lt;http:<span class="hljs-comment">//schema.org/spouse&gt; _:c14n1 .</span></code></pre></div>
<p dir="auto">I am trying to figure out a solution, but haven't found one yet so just submitting this issue at the moment...</p></div>
        <div class="issue" id="issue-container-number-10"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/10"><span class="issue-number">Issue 10</span></a><span class="issue-label">: C14N choice criteria <a class="respec-gh-label" href="https://github.com/w3c/rdf-canon/issues/?q=is%3Aissue+is%3Aopen+label%3A%22documentation%22" style="background-color: rgb(0, 117, 202); color: rgb(255, 255, 255);" aria-label="GitHub label: documentation">documentation</a></span></div><p dir="auto">In the <a href="https://www.w3.org/2022/10/12-rch-minutes.html" rel="nofollow">meeting on 2022-10-12</a>, we discussed criteria that can be used to make a choice between alternative choices in specific steps in the c14n algorithm. The initial list of suggestions is below. We need to formalize this and, IMO, include it in the <a href="https://www.w3.org/2022/07/rch-wg-charter/explainer.html" rel="nofollow">explainer doc</a>.</p>
<ul dir="auto">
<li>ease of implementation</li>
<li>existing incubation / use in the marketplace</li>
<li>time / resource complexity in solving common datasets</li>
<li>time / resource complexity in solving complex (or poison?) datasets</li>
<li>Existence of formal proofs for the algorithms</li>
<li>Demonstration of review of formal proofs for the algorithms</li>
<li>reusing existing primitives that are available on various platforms</li>
<li>cover real life examples</li>
</ul></div>
        <div class="issue" id="issue-container-number-11"><div role="heading" class="issue-title marker" id="h-issue-5" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/11"><span class="issue-number">Issue 11</span></a><span class="issue-label">: Recording the canonicalization and hashing applied.</span></div><p dir="auto">In the <a href="https://www.w3.org/2022/10/12-rch-minutes.html" rel="nofollow">meeting on 2022-10-12</a>, there was mention of needing to say which choices were made in generating the hash.</p>
<p dir="auto">We already have the existing URDNA2015 as the canonicalization algorithm. Anything this working group does that makes any change to that will need to have a way to declare which algorithm was used to produce the resultant canonical form.</p>
<p dir="auto">There may be good reasons for different hashing and signing algorithms.</p>
<p dir="auto">We need a naming scheme of choices made, together with a way to transmit that information.</p>
<p dir="auto">See <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1376301843" data-permission-text="Title is private" data-url="https://github.com/w3c/rdf-canon/issues/4" data-hovercard-type="issue" data-hovercard-url="/w3c/rdf-canon/issues/4/hovercard" href="https://github.com/w3c/rdf-canon/issues/4">#4</a> about the output of canonicalization.</p></div>


    <p>The canonicalization algorithm converts an <a href="#dfn-input-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-dataset-4">input dataset</a>
      into a <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-7">normalized dataset</a>. This algorithm will assign
      deterministic identifiers to any <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-12">blank nodes</a> in the
      <a href="#dfn-input-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-dataset-5">input dataset</a>.</p>

    <div class="note" id="issue-container-generatedID-5"><div role="heading" class="ednote-title marker" id="h-ednote-4" aria-level="4"><span>Editor's note</span></div><p class="">Documenting the algorithm is a WIP, various steps will
      become more detailed in time.</p></div>

    <div class="issue" id="issue-container-number-23"><div role="heading" class="issue-title marker" id="h-issue-6" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/23"><span class="issue-number">Issue 23</span></a><span class="issue-label">: Explore and resolve `simple` loop editor's notes</span></div><p class="">See the issue in for the <a href="#hash-1d-quads" class="sectionRef sec-ref"><bdi class="secno">4.7 </bdi>Hash First Degree Quads</a>. We should either remove the loop based on
      <code>simple</code> here but indicate that the original design
      of the algorithm was to have such a loop, or leave it but
      inform implementers that it is safe to break after one iteration
      of the loop (again, indicating why). A future version of this
      algorithm should make the loop effectual.
    </p></div>

    <section id="canon-algo-overview" class="informative"><div class="header-wrapper"><h4 id="x4-5-1-overview"><bdi class="secno">4.5.1 </bdi>Overview</h4><a class="self-link" href="#canon-algo-overview" aria-label="Permalink for Section 4.5.1"></a></div><p><em>This section is non-normative.</em></p>
      

      <p><a href="#dfn-urdna2015" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-urdna2015-5"><abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr></a> canonically labels an <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-16">RDF dataset</a>.
        In <abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr>, an RDF dataset <var>D</var>
        is represented as a set of <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-5">quads</a> of the form <code>&lt; s, p, o, g &gt;</code>
        where the graph component <code>g</code> is empty if and only if the
        <a href="#dfn-rdf-triple" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-triple-2">triple</a> <code>&lt; s, p, o &gt;</code> is in the <a href="#dfn-default-graph" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-default-graph-1">default graph</a>.
        This algorithm considers an RDF dataset to be a set of quads.
        Two RDF datasets are considered to be isomorphic (i.e., the same modulo blank nodes),
        if and only if they return the same canonically labeled list of quads
        via <a href="#dfn-urdna2015" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-urdna2015-6"><abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr></a>.</p>

      <p><a href="#dfn-urdna2015" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-urdna2015-7"><abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr></a> consists of several sub-algorithms.
        These sub-algorithms are introduced in the following sub-sections.
        First, we give a high level summary of <abbr title="Universal RDF Dataset Canonicalization Algorithm 2015">URDNA2015</abbr>.</p>

      <ol>
        <li id="ca-hl-1"><strong>Initialization</strong>.
          Initialize the state needed for the rest of the algorithm
          using <a href="#canon-state" class="sectionRef sec-ref"><bdi class="secno">4.3 </bdi>Canonicalization State</a>.</li>
        <li id="ca-hl-2"><strong>Compute first degree hashes</strong>.
          Compute the first degree hash for each blank node in the dataset using <a href="#hash-1d-quads" class="sectionRef sec-ref"><bdi class="secno">4.7 </bdi>Hash First Degree Quads</a>.</li>
        <li id="ca-hl-3"><strong>Canonically label unique nodes</strong>.
          Assign canonical identifiers via <a href="#issue-identifier" class="sectionRef sec-ref"><bdi class="secno">4.6 </bdi>Issue Identifier Algorithm</a>,
          in <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-1">Unicode point order</a>, to each blank node whose first degree hash is unique.</li>
        <li id="ca-hl-4"><strong>Compute N-degree hashes for non-unique nodes</strong>.
          For each repeated first degree hash (proceeding in <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-2">Unicode point order</a>),
          compute the N-degree hash via <a href="#hash-nd-quads" class="sectionRef sec-ref"><bdi class="secno">4.9 </bdi>Hash N-Degree Quads</a>
          of every unlabeled blank node that corresponds to the given repeated hash.</li>
        <li id="ca-hl-5"><strong>Canonically label remaining nodes</strong>.
          In <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-3">Unicode point order</a> of the N-degree hashes,
          issue canonical identifiers to each corresponding blank node using
          <a href="#issue-identifier" class="sectionRef sec-ref"><bdi class="secno">4.6 </bdi>Issue Identifier Algorithm</a>.
          If more than one node produces the same N-degree hash,
          the order in which these nodes receive a canonical identifier does not matter.</li>
        <li id="ca-hl-6"><strong>Finish</strong>. Return the normalized dataset.</li>
      </ol>
    </section>

    <section id="canon-algo-algo"><div class="header-wrapper"><h4 id="x4-5-2-algorithm"><bdi class="secno">4.5.2 </bdi>Algorithm</h4><a class="self-link" href="#canon-algo-algo" aria-label="Permalink for Section 4.5.2"></a></div>
      

      <ol>
        <li id="ca-1">Create the <a href="#dfn-canonicalization-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-state-2">canonicalization state</a>.</li>
        <li id="ca-2">For every <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-6">quad</a> <var>Q</var> in <a href="#dfn-input-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-dataset-6">input dataset</a>:
          <ol>
            <li id="ca-2-1">For each <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-13">blank node</a> that is a component of <var>Q</var>,
              add a reference to the <var>Q</var> using the
              <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-18">blank node identifier</a> in the
              <a href="#dfn-blank-node-to-quads-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-to-quads-map-1">blank node to quads map</a>,
              creating a new entry if necessary.
              <div class="issue" id="issue-container-number-15"><div role="heading" class="issue-title marker" id="h-issue-7" aria-level="5"><a href="https://github.com/w3c/rdf-canon/issues/15"><span class="issue-number">Issue 15</span></a><span class="issue-label">: Normalize literals? <a class="respec-gh-label" href="https://github.com/w3c/rdf-canon/issues/?q=is%3Aissue+is%3Aopen+label%3A%22question%22" style="background-color: rgb(216, 118, 227); color: rgb(0, 0, 0);" aria-label="GitHub label: question">question</a></span></div><div class="">
                It seems that <var>Q</var> must be normalized,
                so that literals with different syntactic representations
                but the same semantic representations are merged,
                and that two graphs differing in the syntactic representation
                of a literal will produce the same set of blank node identifiers.</div></div>
            </li>
          </ol>
        </li>
        <li id="ca-3">Create a list of non-normalized <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-19">blank node identifiers</a>
          <var>non-normalized identifiers</var> and populate it using the keys
          from the <a href="#dfn-blank-node-to-quads-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-to-quads-map-2">blank node to quads map</a>.</li>
        <li id="ca-4">Initialize <var>simple</var>, a boolean flag, to
          <code>true</code>.</li>
        <li id="ca-5">While <var>simple</var> is <code>true</code>,
          issue canonical identifiers for <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-14">blank nodes</a>:
          <ol>
            <li id="ca-5-1">Set <var>simple</var> to <code>false</code>.</li>
            <li id="ca-5-2">Clear <a href="#dfn-hash-to-blank-nodes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-to-blank-nodes-map-1">hash to blank nodes map</a>.</li>
            <li id="ca-5-3">For each <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-20">blank node identifier</a>
              <var>n</var> in <var>non-normalized identifiers</var>:
              <ol>
                <li id="ca-5-3-1">Create a <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-5">hash</a>, <var>h<sub>f</sub>(n)</var>,
                  for <var>n</var> according to the
                  <a href="#hash-1d-quads">Hash First Degree Quads algorithm</a>.</li>
                <li id="ca-5-3-2">Add <var>h<sub>f</sub>(n)</var> and <var>n</var> to
                  <a href="#dfn-hash-to-blank-nodes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-to-blank-nodes-map-2">hash to blank nodes map</a>, including repetitions,
                  creating a new entry if necessary.</li>
              </ol>
            </li>
            <li id="ca-5-4">For each <var>hash</var> to <var>identifier list</var> mapping in
              <a href="#dfn-hash-to-blank-nodes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-to-blank-nodes-map-3">hash to blank nodes map</a>, <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-4">code point ordered</a> by
              <var>hash</var>:
              <ol>
                <li id="ca-5-4-1">If  <var>identifier list</var> has more than one entry,
                  continue to the next mapping.</li>
                <li id="ca-5-4-2">Use the
                  <a href="#issue-identifier">Issue Identifier algorithm</a>,
                  passing <a href="#dfn-canonical-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonical-issuer-1">canonical issuer</a> and the
                  single <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-21">blank node identifier</a>, <var>identifier</var> in
                  <var>identifier list</var> to issue a
                  canonical replacement identifier for <var>identifier</var>.</li>
                <li id="ca-5-4-3">Remove <var>identifier</var> from
                  <var>non-normalized identifiers</var>.</li>
                <li id="ca-5-4-4">Remove <var>hash</var> from the
                  <a href="#dfn-hash-to-blank-nodes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-to-blank-nodes-map-4">hash to blank nodes map</a>.</li>
                <li id="ca-5-4-5">Set <var>simple</var> to <code>true</code>.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li id="ca-6">For each <var>hash</var> to <var>identifier list</var> mapping in
          <a href="#dfn-hash-to-blank-nodes-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-to-blank-nodes-map-5">hash to blank nodes map</a>, <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-5">code point ordered</a> by
          <var>hash</var>:
          <ol>
            <li id="ca-6-1">Create <var>hash path list</var> where each item will be a result
              of running the
              <a href="#hash-nd-quads">Hash N-Degree Quads algorithm</a>.</li>
            <li id="ca-6-2">For each <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-22">blank node identifier</a>
              <var>n</var> in <var>identifier list</var>:
              <ol>
                <li id="ca-6-2-1">If a canonical identifier has already been issued for
                  <var>n</var>, continue to the next
                  <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-23">blank node identifier</a>.</li>
                <li id="ca-6-2-2">Create <var>temporary issuer</var>, an
                  <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-4">identifier issuer</a> initialized with the prefix
                  <code>_:b</code>.</li>
                <li id="ca-6-2-3">Use the
                  <a href="#issue-identifier">Issue Identifier algorithm</a>,
                  passing <var>temporary issuer</var> and <var>n</var>, to
                  issue a new temporary <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-24">blank node identifier</a> <var>b<sub>n</sub></var>
                  to <var>n</var>.</li>
                <li id="ca-6-2-4">Run the
                  <a href="#hash-nd-quads">Hash N-Degree Quads algorithm</a>,
                  passing <var>temporary issuer</var>, and append the
                  result to the <var>hash path list</var>.</li>
              </ol>
            </li>
            <li id="ca-6-3">For each <var>result</var> in the <var>hash path list</var>,
              <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-6">code point ordered</a> by the <var>hash</var> in <var>result</var>:
              <ol>
                <li id="ca-6-3-1">For each <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-25">blank node identifier</a>,
                  <var>existing identifier</var>, that was issued a temporary
                  identifier by <var>identifier issuer</var> in <var>result</var>, issue
                  a canonical identifier, in the same order, using the
                  <a href="#issue-identifier">Issue Identifier algorithm</a>,
                  passing <a href="#dfn-canonical-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonical-issuer-2">canonical issuer</a> and
                  <var>existing identifier</var>.
              </li></ol>
            </li>
          </ol>
        </li>
        <li id="ca-7">For each <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-7">quad</a>, <var>q</var>, in <a href="#dfn-input-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-dataset-7">input dataset</a>:
          <ol>
            <li id="ca-7-1">Create a copy, <var>quad copy</var>, of <var>q</var> and replace any
              existing <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-26">blank node identifier</a> <var>n</var> using the
              canonical identifiers previously issued
              by <a href="#dfn-canonical-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonical-issuer-3">canonical issuer</a>.</li>
            <li id="ca-7-2">Add <var>quad copy</var> to the
              <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-8">normalized dataset</a>.</li>
          </ol>
        </li>
        <li id="ca-8">Return the <a href="#dfn-normalized-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-normalized-dataset-9">normalized dataset</a>.</li>
      </ol>
    </section>
  </section>

  <section id="issue-identifier" class="algorithm"><div class="header-wrapper"><h3 id="x4-6-issue-identifier-algorithm"><bdi class="secno">4.6 </bdi>Issue Identifier Algorithm</h3><a class="self-link" href="#issue-identifier" aria-label="Permalink for Section 4.6"></a></div>
    
    

    <section id="issue-identifier-algorithm"><div class="header-wrapper"><h4 id="x4-6-1-algorithm"><bdi class="secno">4.6.1 </bdi>Algorithm</h4><a class="self-link" href="#issue-identifier-algorithm" aria-label="Permalink for Section 4.6.1"></a></div>
      

      <p>This algorithm issues a new <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-27">blank node identifier</a> for
        a given existing <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-28">blank node identifier</a>. It also updates
        state information that tracks the order in which new
        <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-29">blank node identifiers</a> were issued.</p>

      <p>This algorithm takes an <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-5">identifier issuer</a> <var>I</var> and an
        <var>existing identifier</var> as inputs. The output is a new
        <var>issued identifier</var>. The steps of the algorithm are:</p>

      <ol>
        <li id="iia-1">If there is already an issued identifier for
          <var>existing identifier</var> in <a href="#dfn-issued-identifiers-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-issued-identifiers-list-1">issued identifiers list</a> of <var>I</var>,
          return it.</li>
        <li id="iia-2">Generate <var>issued identifier</var> by concatenating
          <a href="#dfn-identifier-prefix" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-prefix-3">identifier prefix</a> with the string value of
          <a href="#dfn-identifier-counter" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-counter-2">identifier counter</a>.</li>
        <li id="iia-3">Append an item to <a href="#dfn-issued-identifiers-list" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-issued-identifiers-list-2">issued identifiers list</a> that maps
          <var>existing identifier</var> to <var>issued identifier</var>.</li>
        <li id="iia-4">Increment <a href="#dfn-identifier-counter" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-counter-3">identifier counter</a>.</li>
        <li id="iia-5">Return <var>issued identifier</var>.</li>
      </ol>
    </section>
  </section>

  <section id="hash-1d-quads" class="algorithm"><div class="header-wrapper"><h3 id="x4-7-hash-first-degree-quads"><bdi class="secno">4.7 </bdi>Hash First Degree Quads</h3><a class="self-link" href="#hash-1d-quads" aria-label="Permalink for Section 4.7"></a></div>
    

    <p>This algorithm calculates a <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-6">hash</a> for a given <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-15">blank node</a>
      across the <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-8">quads</a> in a <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-17">dataset</a> in which that blank node
      is a component.
      If the hash uniquely identifies that blank node,
      no further examination is necessary.
      Otherwise, a hash will be created for the blank node using
      the algorithm in <a href="#hash-nd-quads" class="sectionRef sec-ref"><bdi class="secno">4.9 </bdi>Hash N-Degree Quads</a>
      invoked via <a href="#canon-algorithm" class="sectionRef sec-ref"><bdi class="secno">4.5 </bdi>Canonicalization Algorithm</a>.</p>

    <div class="issue" id="issue-container-number-23-0"><div role="heading" class="issue-title marker" id="h-issue-8" aria-level="4"><a href="https://github.com/w3c/rdf-canon/issues/23"><span class="issue-number">Issue 23</span></a><span class="issue-label">: Explore and resolve `simple` loop editor's notes</span></div><p class="">The result of this algorithm for a
      particular blank node will always be the same. This is only true
      because there was a typo in the spec that has now been implemented
      by many implementations. The design of the algorithm was to use the
      assigned canonical blank node identifier, if available, instead of
      <code>_:a</code> or <code>_:z</code>, similar to how it is used in
      the related hash algorithm, but this text never made it into the spec
      before implementations moved forward. Therefore, the hashes here
      never change, making the loop based on the <code>simple</code>
      flag that calls this algorithm unnecessary; it needs to only run
      once. A future version of this algorithm should correct this mistake.
    </p></div>

    <section id="hash-1d-quads-overview" class="informative"><div class="header-wrapper"><h4 id="x4-7-1-overview"><bdi class="secno">4.7.1 </bdi>Overview</h4><a class="self-link" href="#hash-1d-quads-overview" aria-label="Permalink for Section 4.7.1"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>To determine whether the first degree information of a node <var>n</var> is unique,
        a <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-7">hash</a> is assigned to its <a href="#dfn-mention" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-mention-2">mention set</a>,
        <var>Q<sub>n</sub></var>.
        The first degree hash of a blank node <var>n</var>,
        denoted <var>h<sub>f</sub>(n)</var>,
        is the hash that results from <a href="#hash-1d-quads" class="sectionRef sec-ref"><bdi class="secno">4.7 </bdi>Hash First Degree Quads</a>
        when passing <var>n</var>.
        Nodes with unique first degree hashes have unique first degree information.</p>

      <p>For consistency, <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-30">blank node identifiers</a> used in <var>Q<sub>n</sub></var>
        are replaced with placeholders in an [<cite><a class="bibref" data-link-type="biblio" href="#bib-n-quads" title="RDF 1.1 N-Quads">N-Quads</a></cite>] serialization of that quad.
        Every blank node component is replaced with either <code>_:a</code> or <code>_:z</code>,
        depending on if that component is <var>n</var> or not.</p>

      <p>The resulting serialized quads are then <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-7">code point ordered</a>,
        concatenated, and hashed.
        This hash is the first degree hash of <var>n</var>, <var>h<sub>f</sub>(n)</var>.</p>
    </section>

    <section id="hash-1d-quads-exampkes" class="informative"><div class="header-wrapper"><h4 id="x4-7-2-examples"><bdi class="secno">4.7.2 </bdi>Examples</h4><a class="self-link" href="#hash-1d-quads-exampkes" aria-label="Permalink for Section 4.7.2"></a></div><p><em>This section is non-normative.</em></p>
      

      <aside id="ex-unique-hashes" class="example"><div class="marker">
    <a class="self-link" href="#ex-unique-hashes">Example<bdi> 2</bdi></a><span class="example-title">: Unique hashes</span>
  </div>
        <p>This example illustrates hashing quads containing
          blank nodes where hashing the statements mentioning
          those blank nodes generates unique results.</p>

        <figure id="fig-unique-hashes" style="text-align:center">
          
          <object data="unique-hashes.svg" style="width: 75%" type="image/svg+xml" aria-describedby="fig-unique-hashes-alt">
            <p id="fig-unique-hashes-alt">
              The image represents the graph described in
              <a href="#ex-unique-hashes-input">
                the following code block
              </a>.</p>
          </object>
          <figcaption>Figure <bdi class="figno">1</bdi> <span class="fig-title">An illustration of a graph resulting in unique hashes.<br>
            Image available in
            <a href="unique-hashes.svg" title="SVG image of a unique hashes">
              <abbr title="Scalable Vector Graphics">SVG</abbr>
            </a>.</span></figcaption>
        </figure>

        <pre id="ex-unique-hashes-input" title="Graph with blank nodes resulting in unique hashes" aria-busy="false"><code class="hljs">:p :q _:b0 .
:p :r _:b1 .
_:b0 :s :u .
_:b1 :t :u .</code></pre>

        <p>The algorithm will be called twice, with each blank node (<code>_:b0</code> and <code>_:b1</code>).
          Running the algorithm with the reference node <code>_:b0</code> results in the
          following quads, after replacing blank nodes:</p>

        <pre aria-busy="false"><code class="hljs">:p :q _:a .
_:a :s :u .</code></pre>

        <p>These are then serialized to N-Quads, concatenated and hashed
          using the <a href="#dfn-hash-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-algorithm-1">hash algorithm</a> (SHA-256) resulting in
          <code>21d1dd5ba21f3dee9d76c0c00c260fa6f5d5d65315099e553026f4828d0dc77a</code>.</p>

        <p>The algorithm is run a second time with the reference node <code>_:b1</code> resulting
          in the following quads:</p>

        <pre aria-busy="false"><code class="hljs">:p :r _:a .
_:a :t :u .</code></pre>

        <p>These are then serialized to N-Quads, concatenated and hashed as before resulting in
          <code>6fa0b9bdb376852b5743ff39ca4cbf7ea14d34966b2828478fbf222e7c764473</code>.</p>

        <p>Thus the generated hashes each reference just a single blank node,
          allowing the canonicalization algorithm to use only the
          Hash First Degree Quads algorithm.</p>
      </aside>

      <aside id="ex-shared-hashes" class="example"><div class="marker">
    <a class="self-link" href="#ex-shared-hashes">Example<bdi> 3</bdi></a><span class="example-title">: Shared hashes</span>
  </div>
        <p>This example illustrates hashing quads containing
          blank nodes where hashing the statements mentioning
          those blank nodes have overlapping results.</p>

        <figure id="fig-shared-hashes" style="text-align:center">
          
          <object data="shared-hashes.svg" style="width: 75%" type="image/svg+xml" aria-describedby="fig-shared-hashes-alt">
            <p id="fig-shared-hashes-alt">
              The image represents the graph described in
              <a href="#ex-shared-hashes-input">
                the following code block
              </a>.</p>
          </object>
          <figcaption>Figure <bdi class="figno">2</bdi> <span class="fig-title">An illustration of a graph resulting in shared hashes.<br>
            Image available in
            <a href="shared-hashes.svg" title="SVG image of a graph resulting in shared hashes">
              <abbr title="Scalable Vector Graphics">SVG</abbr>
            </a>.</span></figcaption>
        </figure>
          
        <pre id="ex-shared-hashes-input" title="Graph with blank nodes resulting in shared hashes" aria-busy="false"><code class="hljs">:p :q _:b0 .
:p :q _:b1 .
_:b0 :p _:b2 .
_:b1 :p _:b3 .
_:b2 :r _:b3 .</code></pre>

        <p>The algorithm will be called four times, with each blank node
          (<code>_:b0</code>, <code>_:b1</code>, <code>_:b2</code>, and <code>_:b3</code>).
          Running the algorithm with the reference node <code>_:b0</code> results in the
          following quads, after replacing blank nodes:</p>

        <pre aria-busy="false"><code class="hljs">:p :q _:a .
_:a :p _:z .</code></pre>

        <p>Which hashes to: <code>3b26142829b8887d011d779079a243bd61ab53c3990d550320a17b59ade6ba36</code>.</p>

        <p>Note that using reference node <code>_:b1</code> results in the same quads,
          and thus results in the same hash.</p>

        <p>Using the reference node <code>_:b2</code> results in the following quads:</p>

        <pre aria-busy="false"><code class="hljs">_:z :p _:a .
_:a :r _:z .</code></pre>

        <p>Which hashes to: <code>15973d39de079913dac841ac4fa8c4781c0febfba5e83e5c6e250869587f8659</code>.</p>

        <p>Lastly, using the reference node <code>_:b3</code> results in the following quads:</p>

        <pre aria-busy="false"><code class="hljs">_:z :r _:a .
_:z :p _:a .</code></pre>

        <p>Which hashes to: <code>3b26142829b8887d011d779079a243bd61ab53c3990d550320a17b59ade6ba36</code>.</p>

        <p>The hashes for <code>_:b2</code> and <code>_:b3</code> are unique, but <code>_:b0</code>,
          and <code>_:b1</code> share a common hash,
          which will require the use of the
          <a href="#hash-nd-quads-algorithm">Hash N-Degree Quads Algorithm</a>,
          as it is necessary to consider quads further removed from the direct mentions
          to determine a unique hash.</p>
      </aside>
    </section>

    <section id="hash-1d-quads-algorithm"><div class="header-wrapper"><h4 id="x4-7-3-algorithm"><bdi class="secno">4.7.3 </bdi>Algorithm</h4><a class="self-link" href="#hash-1d-quads-algorithm" aria-label="Permalink for Section 4.7.3"></a></div>
      

      <p>This algorithm takes the <a href="#dfn-canonicalization-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-state-3">canonicalization state</a> and a
        <dfn id="dfn-reference-blank-node-identifier" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">reference blank node identifier</dfn> as inputs.</p>

      <ol>
        <li id="h1d-1">Initialize <dfn id="dfn-nquads" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">nquads</dfn> to an empty list. It will be
          used to store quads in [<cite><a class="bibref" data-link-type="biblio" href="#bib-n-quads" title="RDF 1.1 N-Quads">N-Quads</a></cite>] format.</li>
        <li id="h1d-2">Get the list of <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-9">quads</a> <var>quads</var> associated with the
          <a href="#dfn-reference-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-reference-blank-node-identifier-1">reference blank node identifier</a> in the
          <a href="#dfn-blank-node-to-quads-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-to-quads-map-3">blank node to quads map</a>.</li>
        <li id="h1d-3">For each <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-10">quad</a> <var>quad</var> in <var>quads</var>:
          <ol>
            <li id="h1d-3-1">Serialize the <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-11">quad</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-n-quads" title="RDF 1.1 N-Quads">N-Quads</a></cite>] format with the
              following special rule:
              <ol>
                <li id="h1d-3-1-1">If any component in <var>quad</var> is an
                  <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-16">blank node</a>, then serialize it using a
                  special identifier as follows:
                  <ol>
                    <li id="h1d-3-1-1-1">If the <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-17">blank node</a>'s existing
                    <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-31">blank node identifier</a> matches the
                    <a href="#dfn-reference-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-reference-blank-node-identifier-2">reference blank node identifier</a> then use the
                    <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-32">blank node identifier</a> <code>_:a</code>,
                    otherwise, use the <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-33">blank node identifier</a>
                    <code>_:z</code>.</li>
                  </ol>
                </li>
              </ol>
              <div class="issue" id="issue-container-number-15-0"><div role="heading" class="issue-title marker" id="h-issue-9" aria-level="5"><a href="https://github.com/w3c/rdf-canon/issues/15"><span class="issue-number">Issue 15</span></a><span class="issue-label">: Normalize literals? <a class="respec-gh-label" href="https://github.com/w3c/rdf-canon/issues/?q=is%3Aissue+is%3Aopen+label%3A%22question%22" style="background-color: rgb(216, 118, 227); color: rgb(0, 0, 0);" aria-label="GitHub label: question">question</a></span></div><p class="">
                Note potential need to normalize literals to their
                canonical representation here as well,
                if not done on the original <a href="#dfn-input-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-dataset-8">input dataset</a>.</p></div>
            </li>
          </ol>
        </li>
        <li id="h1d-4">Sort <a href="#dfn-nquads" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-nquads-1">nquads</a> in <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-8">Unicode point order</a>.</li>
        <li id="h1d-5">Return the <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-8">hash</a> that results from passing the sorted,
          joined <a href="#dfn-nquads" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-nquads-2">nquads</a> through the
          <a href="#dfn-hash-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-algorithm-2">hash algorithm</a>.</li>
      </ol>
    </section>
  </section>

  <section id="hash-related-blank-node" class="algorithm"><div class="header-wrapper"><h3 id="x4-8-hash-related-blank-node"><bdi class="secno">4.8 </bdi>Hash Related Blank Node</h3><a class="self-link" href="#hash-related-blank-node" aria-label="Permalink for Section 4.8"></a></div>
    

    <section id="hash-related-bn-overview" class="informative"><div class="header-wrapper"><h4 id="x4-8-1-overview"><bdi class="secno">4.8.1 </bdi>Overview</h4><a class="self-link" href="#hash-related-bn-overview" aria-label="Permalink for Section 4.8.1"></a></div><p><em>This section is non-normative.</em></p>
      

      <div class="note" id="issue-container-generatedID-6"><div role="heading" class="ednote-title marker" id="h-ednote-5" aria-level="5"><span>Editor's note</span></div><p class="">The text from the Arnold/Longley paper
        is a bit opaque here; recasting this in simpler terms
        would be more useful for the target audience.</p></div>
    </section>

    <section id="hash-related-algorithm"><div class="header-wrapper"><h4 id="x4-8-2-algorithm"><bdi class="secno">4.8.2 </bdi>Algorithm</h4><a class="self-link" href="#hash-related-algorithm" aria-label="Permalink for Section 4.8.2"></a></div>
      

      <p>This algorithm creates a <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-9">hash</a> to identify how one
        <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-18">blank node</a> is related to another. It takes the
        <a href="#dfn-canonicalization-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-state-4">canonicalization state</a>, a <var>related</var>
        <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-34">blank node identifier</a>, a <var>quad</var>, an
        <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-6">identifier issuer</a>, <var>issuer</var>, and a
        <a href="#dfn-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-string-2">string</a> <var>position</var> as inputs.</p>

      <ol>
        <li id="hrbn-1">Set the <var>identifier</var> to use for <var>related</var>, preferring
          first the canonical identifier for <var>related</var> if issued, second
          the identifier issued by <var>issuer</var> if issued, and last, if
          necessary, the result of the
          <a href="#hash-1d-quads">Hash First Degree Quads algorithm</a>,
          passing <var>related</var>.
        </li>
        <li id="hrbn-2">Initialize a <a href="#dfn-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-string-3">string</a> <var>input</var> to the value of
          <var>position</var>.</li>
        <li id="hrbn-3">If <var>position</var> is not <code>g</code>, append
          <code>&lt;</code>, the value of the <a href="#dfn-predicate" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-predicate-2">predicate</a> in
          <var>quad</var>, and <code>&gt;</code> to <var>input</var>.</li>
        <li id="hrbn-4">Append <var>identifier</var> to <var>input</var>.</li>
        <li id="hrbn-5">Return the <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-10">hash</a> that results from passing <var>input</var>
          through the <a href="#dfn-hash-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-algorithm-3">hash algorithm</a>.</li>
      </ol>
    </section>
  </section>

  <section id="hash-nd-quads" class="algorithm"><div class="header-wrapper"><h3 id="x4-9-hash-n-degree-quads"><bdi class="secno">4.9 </bdi>Hash N-Degree Quads</h3><a class="self-link" href="#hash-nd-quads" aria-label="Permalink for Section 4.9"></a></div>
    

    <p>This algorithm calculates a <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-11">hash</a> for a given <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-19">blank node</a>
      across the <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-12">quads</a> in a <a href="#dfn-rdf-dataset" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-rdf-dataset-18">dataset</a> in which that blank node
      is a component for which the hash does not uniquely identify that blank node.
      This is done by expanding the search from quads directly referencing that
      blank node (the <a href="#dfn-mention" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-mention-3">mention set</a>), to those quads
      which contain nodes which are also components of quads in the mention set,
      called the <a href="#dfn-gossip-path" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gossip-path-1">gossip path</a>.
      This process proceeds in every greater degrees of indirection until
      a unique hash is obtained.</p>

    <div class="note" id="issue-container-generatedID-7"><div role="heading" class="ednote-title marker" id="h-ednote-6" aria-level="4"><span>Editor's note</span></div><p class="">There may also be better names for the two algorithms.</p></div>

    <div class="note" id="issue-container-generatedID-8"><div role="heading" class="ednote-title marker" id="h-ednote-7" aria-level="4"><span>Editor's note</span></div><p class="">The 'path' terminology could also be changed to better
      indicate what a path is (a particular deterministic serialization for
      a subgraph/subdataset of nodes without globally-unique identifiers).</p></div>

    <section id="hash-nd-quads-overview" class="informative"><div class="header-wrapper"><h4 id="x4-9-1-overview"><bdi class="secno">4.9.1 </bdi>Overview</h4><a class="self-link" href="#hash-nd-quads-overview" aria-label="Permalink for Section 4.9.1"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>Usually, when trying to determine if two nodes in a graph are
        equivalent, you simply compare their identifiers. However, what if the
        nodes don't have identifiers? Then you must determine if the two nodes
        have equivalent connections to equivalent nodes all throughout the
        whole graph. This is called the <a href="#dfn-graph-isomorphism" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-graph-isomorphism-1">graph isomorphism</a> problem. This
        algorithm approaches this problem by considering how one might draw
        a graph on paper. You can test to see if two nodes are equivalent
        by drawing the graph twice. The first time you draw the graph the
        first node is drawn in the center of the page. If you can draw the
        graph a second time such that it looks just like the first, except
        the second node is in the center of the page, then the nodes are
        equivalent. This algorithm essentially defines a deterministic way to
        draw a graph where, if you begin with a particular node, the graph
        will always be drawn the same way. If two graphs are drawn the same way
        with two different nodes, then the nodes are equivalent. A
        <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-12">hash</a> is used to indicate a particular way that the graph
        has been drawn and can be used to compare nodes.</p>

      <p>When two blank nodes have the same first degree hash,
        extra steps must be taken to detect global,
        or <em>N</em>-degree, distinctions.
        All information that is in any way connected to the blank node <var>n</var>
        through other blank nodes, even transitively, must be considered.</p>

      <p>To consider all transitive information,
        the algorithm traverses and encodes all possible paths of incident
        mentions emanating from <var>n</var>, called <a href="#dfn-gossip-path" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gossip-path-2">gossip paths</a>,
        that reach every unlabeled blank node connected to <var>n</var>.
        Each unlabeled blank node is assigned a temporary label
        in the order in which it is reached in the
        gossip path being explored.
        The mentions that are traversed to reach
        connected blank nodes are encoded in these paths via related hashes.
        This provides a deterministic way to order all paths coming from <var>n</var> that
        reach all blank nodes connected to n without relying on input blank
        node labels.</p>
  
      <p>This algorithm works in concert with the main canonicalization algorithm
        to produce a unique, deterministic identifier for a particular blank
        node. This <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-13">hash</a> incorporates all of the information that
        is connected to the blank node as well as how it is connected. It does
        this by creating deterministic paths that emanate out from the blank
        node through any other adjacent blank nodes.</p>

      <p>Ultimately, the algorithm selects a shortest <a href="#dfn-gossip-path" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gossip-path-3">gossip path</a>,
        distributing canonical labels to the unlabeled blank nodes
        in the order in which they appear in this path.
        The hash of this encoded shortest path,
        called the N-degree hash of <var>n</var>,
        distinguishes <var>n</var> from other blank nodes in the dataset.</p>

      <p>For clarity, we consider a <a href="#dfn-gossip-path" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gossip-path-4">gossip path</a> encoded via the string <var>s</var>
        to be shortest provided that:</p>

      <ol>
        <li>The length of <var>s</var> is less than or equal to the length
          of any other gossip path string <var>s′</var>.</li>
        <li>If <var>s</var> and <var>s′</var> have the same length (as strings),
          then <var>s</var> is <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-9">code point ordered</a> less than or equal to <var>s′</var>.</li>
      </ol>

      <p>For example, <em>abc</em> is shorter than <em>bbc</em>,
        whereas <em>abcd</em> is longer than <em>bcd</em>.</p>

      <p>The following provides a high level outline for how the N-degree hash of <var>n</var>
        is computed along the shortest <a href="#dfn-gossip-path" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gossip-path-5">gossip path</a>.
        Note that the full algorithm considers all gossip paths,
        ultimately returning the <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-14">hash</a> of the shortest encoded path.</p>

      <ol>
        <li id="ndh-hl-s1"><strong>Compute related hashes</strong>.
          Compute the related hash <var>H<sub>n</sub></var> set for <var>n</var>,
          i.e., all first degree <a href="#dfn-mention" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-mention-4">mentions</a> between <var>n</var> and another blank node.
          Note that this includes both labeled and unlabeled blank nodes.</li>
        <li id="ndh-hl-s2"><strong>Explore mentions</strong>.
          Given the related hash <var>x</var> in <var>H<sub>n</sub></var>,
          record <var>x</var> in the data to hash <var>D<sub>n</sub></var>.
          Determine whether each blank node reachable via the <a href="#dfn-mention" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-mention-5">mention</a> with related hash <var>x</var>
          has already received a label.
          <ol>
            <li id="ndh-hl-s2-1"><strong>Record the labels of labeled nodes</strong>.
              If a blank node already has a label,
              record its label in <var>D<sub>n</sub></var> once for every
              <a href="#dfn-mention" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-mention-6">mention</a> with related hash <var>x</var>.
              Skip to the next related hash in <var>H<sub>n</sub></var>
              and repeat <a href="#ndh-hl-s2">step 2</a>.</li>
            <li id="ndh-hl-s2-2"><strong>Distribute and record temporary labels to unlabeled nodes</strong>.
              For each unlabeled blank node,
              assign it a temporary label according to the order in which it is reached in the gossip path,
              recording its given label in <var>D<sub>n</sub></var> (including repetitions).
              Add each unlabeled node to the recursion list <var>R<sub>n</sub>(x)</var>
              in this same order (omitting repetitions).</li>
            <li id="ndh-hl-s2-3"><strong>Recurse on newly labeled nodes</strong>.
              For each <var>n<sub>i</sub></var> in <var>R<sub>n</sub>(x)</var>
              <ol>
                <li id="ndh-hl-s2-3-1">Record its label in <var>D<sub>n</sub></var></li>
                <li id="ndh-hl-s2-3-2">Append &lt; <var>r(i)</var> &gt; to <var>D<sub>n</sub></var>
                  where <var>r(i)</var> is the data to hash that results from returning to
                  <a href="#ndh-hl-s1">step 1</a>,
                  replacing <var>n</var> with <var>n<sub>i</sub></var>.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li id="ndh-hl-s3"><strong>Compute the <em>N</em>-degree hash of n</strong>.
          Hash <var>D<sub>n</sub></var> to return the <em>N</em>-degree hash of <var>n</var>,
          namely <var>h<sub>N</sub>(n)</var>.
          Return the updated issuer <var>I<sub>n</sub></var>
          that has now distributed temporary labels to all unlabeled blank nodes connected to <var>n</var>.</li>
      </ol>

      <p>As described above in <a href="#ndh-hl-s2-3">step 2.3</a>,
        <var>HN</var> recurses on each unlabeled blank node
        when it is first reached along the <a href="#dfn-gossip-path" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gossip-path-6">gossip path</a> being explored.
        This recursion can be visualized as moving along the path from <var>n</var>
        to the blank node <var>n<sub>i</sub></var> that is receiving a temporary identifier.
        If, when recursing on <var>n<sub>i</sub></var>,
        another unlabeled blank node <var>n<sub>j</sub></var> is discovered,
        the algorithm again recurses.
        Such a recursion traces out the <a href="#dfn-gossip-path" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-gossip-path-7">gossip path</a> from <var>n</var>
        to <var>n<sub>j</sub></var> via <var>n<sub>i</sub></var>.</p>

      <p>The recursive hash <var>r(i)</var> is the <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-15">hash</a> returned from
        the completed recursion on the node <var>n<sub>i</sub></var>
        when computing <var>h<sub>N</sub>(n)</var>.
        Just as <var>h<sub>N</sub>(n)</var> is the hash of <var>D<sub>n</sub></var>,
        we denote the data to hash in the recursion on <var>n<sub>i</sub></var>
        as <var>D<sub>i</sub></var>.
        So, <var>r(i)</var> = <var>h(D<sub>i</sub>)</var>.
        For each related hash <var>x</var> ∈ <var>H<sub>n</sub></var>,
        <var>R<sub>n</sub>(x)</var> is called the <em>recursion list</em> on
        which the algorithm recurses.</p>
    </section>

    <section id="hash-nd-quads-exampkes" class="informative"><div class="header-wrapper"><h4 id="x4-9-2-examples"><bdi class="secno">4.9.2 </bdi>Examples</h4><a class="self-link" href="#hash-nd-quads-exampkes" aria-label="Permalink for Section 4.9.2"></a></div><p><em>This section is non-normative.</em></p>
      

      <div class="note" id="issue-container-generatedID-9"><div role="heading" class="ednote-title marker" id="h-ednote-8" aria-level="5"><span>Editor's note</span></div><p class="">
        Add some examples ranging from simple to complicated and resource consuming.
      </p></div>
    </section>

    <section id="hash-nd-quads-algorithm"><div class="header-wrapper"><h4 id="x4-9-3-algorithm"><bdi class="secno">4.9.3 </bdi>Algorithm</h4><a class="self-link" href="#hash-nd-quads-algorithm" aria-label="Permalink for Section 4.9.3"></a></div>
      

      <div class="issue" id="issue-container-number-16"><div role="heading" class="issue-title marker" id="h-issue-10" aria-level="5"><a href="https://github.com/w3c/rdf-canon/issues/16"><span class="issue-number">Issue 16</span></a><span class="issue-label">: Optionally fail on duplicates in Hash N-Degree Quads? <a class="respec-gh-label" href="https://github.com/w3c/rdf-canon/issues/?q=is%3Aissue+is%3Aopen+label%3A%22question%22" style="background-color: rgb(216, 118, 227); color: rgb(0, 0, 0);" aria-label="GitHub label: question">question</a></span></div><div class="">
        An additional input to this algorithm should be added that
        allows it to be optionally skipped and throw an error if any
        equivalent related hashes were produced that must be permuted
        during step 5.4.4. For practical uses of the algorithm, this step
        should never be encountered and could be turned off, disabling
        canonizing datasets that include a need to run it as a security
        measure.
      </div></div>

      <p>The inputs to this algorithm are the <a href="#dfn-canonicalization-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-state-5">canonicalization state</a>,
        the <var>identifier</var> for the <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-20">blank node</a> to
        recursively hash quads for, and path identifier <var>issuer</var> which is
        an <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-7">identifier issuer</a> that issues temporary
        <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-35">blank node identifier</a>s. The output from this algorithm
        will be a <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-16">hash</a> and the <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-8">identifier issuer</a> used
        to help generate it.</p>

      <ol>
        <li id="hndq-1">Create a <var>hash to related blank nodes map</var> for storing
          hashes that identify related <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-21">blank nodes</a>.</li>
        <li id="hndq-2">Get a reference, <var>quads</var>, to the list of <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-13">quads</a>
          in the <a href="#dfn-blank-node-to-quads-map" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-to-quads-map-4">blank node to quads map</a> for the key
          <var>identifier</var>.</li>
        <li id="hndq-3">For each <var>quad</var> in <var>quads</var>:
          <ol>
            <li id="hndq-3-1">For each <var>component</var> in <var>quad</var>, where <var>component</var>
              is the <a href="#dfn-subject" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subject-2">subject</a>, <a href="#dfn-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-object-2">object</a>, or
              <a href="#dfn-graph-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-graph-name-3">graph name</a>, and it is a
              <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-22">blank node</a> that is not identified by
              <var>identifier</var>:
              <ol>
                <li id="hndq-3-1-1">Set <var>hash</var> to the result of the
                  <a href="#hash-related-blank-node">Hash Related Blank Node algorithm</a>,
                  passing the <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-36">blank node identifier</a> for
                  <var>component</var> as <var>related</var>, <var>quad</var>,
                  <var>path identifier issuer</var> as <var>issuer</var>, and
                  <var>position</var> as either <code>s</code>, <code>o</code>, or
                  <code>g</code> based on whether <var>component</var> is a
                  <a href="#dfn-subject" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subject-3">subject</a>, <a href="#dfn-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-object-3">object</a>,
                  <a href="#dfn-graph-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-graph-name-4">graph name</a>, respectively.</li>
                <li id="hndq-3-1-2">Add a mapping of <var>hash</var> to the
                  <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-37">blank node identifier</a> for <var>component</var>
                  to <var>hash to related blank nodes map</var>, adding an entry
                  as necessary.</li>
              </ol>
            </li>
          </ol>
        </li>
        <li id="hndq-4">Create an empty string, <var>data to hash</var>.</li>
        <li id="hndq-5">For each <var>related hash</var> to <var>blank node list</var> mapping in
          <var>hash to related blank nodes map</var>, <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-10">code point ordered</a>
          by <var>related hash</var>:
          <ol>
            <li id="hndq-5-1">Append the <var>related hash</var> to the <var>data to hash</var>.</li>
            <li id="hndq-5-2">Create a <a href="#dfn-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-string-4">string</a> <var>chosen path</var>.</li>
            <li id="hndq-5-3">Create an unset <var>chosen issuer</var> variable.</li>
            <li id="hndq-5-4">For each <var>permutation</var> of <var>blank node list</var>:
              <ol>
                <li id="hndq-5-4-1">Create a copy of <var>issuer</var>, <var>issuer copy</var>.</li>
                <li id="hndq-5-4-2">Create a <a href="#dfn-string" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-string-5">string</a> <var>path</var>.</li>
                <li id="hndq-5-4-3">Create a <var>recursion list</var>, to store
                  <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-38">blank node identifiers</a> that must be
                  recursively processed by this algorithm.</li>
                <li id="hndq-5-4-4">For each <var>related</var> in <var>permutation</var>:
                  <ol>
                    <li id="hndq-5-4-4-1">If a canonical identifier has been issued for
                      <var>related</var>, append it to <var>path</var>.</li>
                    <li id="hndq-5-4-4-2">Otherwise:
                      <ol>
                        <li id="hndq-5-4-4-2-1">If <i>issuer copy</i> has not issued
                          an identifier for <var>related</var>, append
                          <var>related</var> to <var>recursion list</var>.</li>
                        <li id="hndq-5-4-4-2-2">Use the
                          <a href="#issue-identifier">Issue Identifier algorithm</a>,
                          passing <var>issuer copy</var> and <var>related</var> and
                          append the result to <var>path</var>.</li>
                      </ol>
                    </li>
                    <li id="hndq-5-4-4-3">If <var>chosen path</var> is not empty and the length
                      of <var>path</var> is greater than or equal to the length
                      of <var>chosen path</var> and <var>path</var> is
                      greater than <var>chosen path</var> when
                      considering <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-11">code point order</a>,
                      then skip to the next <var>permutation</var>.
                    </li>
                  </ol>
                </li>
                <li id="hndq-5-4-5">For each <var>related</var> in <var>recursion list</var>:
                  <ol>
                    <li id="hndq-5-4-5-1">Set <var>result</var> to the result of recursively executing
                      the
                      <a href="#hash-nd-quads">Hash N-Degree Quads algorithm</a>,
                      passing <var>related</var> for <var>identifier</var> and
                      <var>issuer copy</var> for <var>path identifier issuer</var>.</li>
                    <li id="hndq-5-4-5-2">Use the
                      <a href="#issue-identifier">Issue Identifier algorithm</a>,
                      passing <var>issuer copy</var> and <var>related</var> and
                      append the result to <var>path</var>.</li>
                    <li id="hndq-5-4-5-3">Append <code>&lt;</code>, the <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-17">hash</a> in
                      <var>result</var>, and <code>&gt;</code> to <var>path</var>.</li>
                    <li id="hndq-5-4-5-4">Set <var>issuer copy</var> to the
                      <a href="#dfn-identifier-issuer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-identifier-issuer-9">identifier issuer</a> in result.</li>
                    <li id="hndq-5-4-5-5">If <var>chosen path</var> is not empty and the length
                      of <var>path</var> is greater than or equal to the length
                      of <var>chosen path</var> and <var>path</var> is
                      greater than <var>chosen path</var> when considering <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-12">code point order</a>,
                      then skip to the next <var>permutation</var>.</li>
                  </ol>
                </li>
                <li id="hndq-5-4-6">If <var>chosen path</var> is empty or <var>path</var> is
                  less than <var>chosen path</var> when considering <a href="#dfn-code-point-order" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-code-point-order-13">code point order</a>,
                  set <var>chosen path</var> to <var>path</var> and <var>chosen issuer</var>
                  to <var>issuer copy</var>.</li>
              </ol>
            </li>
            <li id="hndq-5-5">Append <var>chosen path</var> to <var>data to hash</var>.</li>
            <li id="hndq-5-6">Replace <var>issuer</var>, by reference, with
              <var>chosen issuer</var>.</li>
          </ol>
        </li>
        <li id="hndq-6">Return <var>issuer</var> and the <a href="#dfn-hash" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-18">hash</a> that results from
          passing <var>data to hash</var> through the
          <a href="#dfn-hash-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hash-algorithm-4">hash algorithm</a>.</li>
      </ol>
    </section>
  </section>
</section>

<section id="privacy-considerations"><div class="header-wrapper"><h2 id="x5-privacy-considerations"><bdi class="secno">5. </bdi>Privacy Considerations</h2><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Section 5."></a></div>
  

  <div class="note" id="issue-container-generatedID-10"><div role="heading" class="ednote-title marker" id="h-ednote-9" aria-level="3"><span>Editor's note</span></div><p class="">TBD</p></div>
</section>

<section id="security-considerations"><div class="header-wrapper"><h2 id="x6-security-considerations"><bdi class="secno">6. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 6."></a></div>
  

  <div class="note" id="issue-container-generatedID-11"><div role="heading" class="ednote-title marker" id="h-ednote-10" aria-level="3"><span>Editor's note</span></div><p class="">TBD</p></div>
</section>

<section id="use-cases" class="informative"><div class="header-wrapper"><h2 id="x7-use-cases"><bdi class="secno">7. </bdi>Use Cases</h2><a class="self-link" href="#use-cases" aria-label="Permalink for Section 7."></a></div><p><em>This section is non-normative.</em></p>
  
  <div class="note" id="issue-container-generatedID-12"><div role="heading" class="ednote-title marker" id="h-ednote-11" aria-level="3"><span>Editor's note</span></div><p class="">TBD</p></div>
</section>

<section id="examples" class="informative"><div class="header-wrapper"><h2 id="x8-examples"><bdi class="secno">8. </bdi>Examples</h2><a class="self-link" href="#examples" aria-label="Permalink for Section 8."></a></div><p><em>This section is non-normative.</em></p>
  
  <div class="note" id="issue-container-generatedID-13"><div role="heading" class="ednote-title marker" id="h-ednote-12" aria-level="3"><span>Editor's note</span></div><p class="">TBD</p></div>
</section>

<section id="urgna2021" class="appendix informative algorithm"><div class="header-wrapper"><h2 id="a-urgna2012"><bdi class="secno">A. </bdi><abbr title="Universal RDF Graph Canonicalization Algorithm 2012">URGNA2012</abbr></h2><a class="self-link" href="#urgna2021" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
  
  <p>A previous version of this algorithm has light deployment. For purposes of identification,
    the algorithm is called the
    "Universal RDF Graph Canonicalization Algorithm 2012"
    (<abbr title="Universal RDF Graph Canonicalization Algorithm 2012"><dfn class="export" data-export="" id="dfn-urgna2012" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><abbr title="Universal RDF Graph Canonicalization Algorithm 2012">URGNA2012</abbr></dfn></abbr>),
    and differs from the stated algorithm in the following ways:</p>
  <ul>
    <li>In <a href="#hash-1d-quads" class="sectionRef sec-ref"><bdi class="secno">4.7 </bdi>Hash First Degree Quads</a>, if any blank node was used in the <a href="#dfn-graph-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-graph-name-5">graph name</a>
      position in the <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-14">quad</a>, then the value was serialized using
      the special <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-39">blank node identifier</a>, <code>_:g</code>, instead of <code>_:z</code>.</li>
    <li>In <a href="#hash-related-blank-node" class="sectionRef sec-ref"><bdi class="secno">4.8 </bdi>Hash Related Blank Node</a>, value of the <a href="#dfn-predicate" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-predicate-3">predicate</a>
      was not delimited by <code>&lt;</code> and <code>&gt;</code>; there
      were no delimiters.</li>
    <li>In <a href="#hash-nd-quads" class="sectionRef sec-ref"><bdi class="secno">4.9 </bdi>Hash N-Degree Quads</a>, the <var>position</var> parameter passed to
      the <a href="#hash-related-blank-node">Hash Related Blank Node algorithm</a>
      was instead modeled as a <var>direction</var> parameter, where it could have
      the value <code>p</code>, for property, when the related blank node was a
      <a href="#dfn-subject" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subject-4">subject</a> and the value <code>r</code>, for reverse or reference, when
      the related blank node was an <a href="#dfn-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-object-4">object</a>. Since <a href="#dfn-urgna2012" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-urgna2012-1"><abbr title="Universal RDF Graph Canonicalization Algorithm 2012">URGNA2012</abbr></a> only normalized
      graphs, not datasets, there was no use of the <a href="#dfn-graph-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-graph-name-6">graph name</a> position.</li>
    <li>In <a href="#hash-nd-quads" class="sectionRef sec-ref"><bdi class="secno">4.9 </bdi>Hash N-Degree Quads</a>, building the
      <var>hash to related blank nodes map</var> was done as follows:
      <ol>
        <li id="urgna-1">For each <var>quad</var> in <var>quads</var>:
          <ol>
            <li id="urgna-1-1">If the <var>quad</var>'s <a href="#dfn-subject" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subject-5">subject</a> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-23">blank node</a> that does not
              match <var>identifier</var>, set <var>hash</var> to the result of the
                <a href="#hash-related-blank-node">Hash Related Blank Node algorithm</a>,
                passing the <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-40">blank node identifier</a> for
                <a href="#dfn-subject" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subject-6">subject</a> as <var>related</var>, <var>quad</var>,
                <var>path identifier issuer</var> as <var>issuer</var>, and
                <code>p</code> as <var>position</var>.
            </li>
            <li id="urgna-1-2">Otherwise, if <var>quad</var>'s <a href="#dfn-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-object-5">object</a> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-24">blank node</a> that does
              not match <var>identifier</var>, set <var>hash</var> to the result of the
                <a href="#hash-related-blank-node">Hash Related Blank Node algorithm</a>,
                passing the <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-41">blank node identifier</a> for
                <a href="#dfn-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-object-6">object</a> as <var>related</var>, <var>quad</var>,
                <var>path identifier issuer</var> as <var>issuer</var>, and
                <code>r</code> as <var>position</var>.
            </li>
            <li id="urgna-1-3">Otherwise, continue to the next quad.</li>
            <li id="urgna-1-4">Add a mapping of <var>hash</var> to the
              <a href="#dfn-blank-node-identifier" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-blank-node-identifier-42">blank node identifier</a> for the component
              that matched (<a href="#dfn-subject" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subject-7">subject</a> or <a href="#dfn-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-object-7">object</a>) to
              <var>hash to related blank nodes map</var>, adding an entry
              as necessary.</li>
          </ol>
        </li>
      </ol>
    </li>
  </ul>
</section>

<section id="issue-summary" class="appendix informative"><div class="header-wrapper"><h2 id="b-issue-summary"><bdi class="secno">B. </bdi>Issue summary</h2><a class="self-link" href="#issue-summary" aria-label="Permalink for Appendix B."></a></div><p><em>This section is non-normative.</em></p><ul><li><a href="#issue-container-number-18">Issue 18</a><span style="text-transform: none">: Unicode ordering</span></li><li><a href="#issue-container-number-4">Issue 4</a><span style="text-transform: none">: What is the output of the c14n algorithm?</span></li><li><a href="#issue-container-number-6">Issue 6</a><span style="text-transform: none">: Compare the two algorithms, and decide on basis for our work</span></li><li><a href="#issue-container-number-7">Issue 7</a><span style="text-transform: none">: Support generalized RDF</span></li><li><a href="#issue-container-number-8">Issue 8</a><span style="text-transform: none">: "Herd-privacy" canonicalization</span></li><li><a href="#issue-container-number-10">Issue 10</a><span style="text-transform: none">: C14N choice criteria</span></li><li><a href="#issue-container-number-11">Issue 11</a><span style="text-transform: none">: Recording the canonicalization and hashing applied.</span></li><li><a href="#issue-container-number-23">Issue 23</a><span style="text-transform: none">: Explore and resolve `simple` loop editor's notes</span></li><li><a href="#issue-container-number-15">Issue 15</a><span style="text-transform: none">: Normalize literals?</span></li><li><a href="#issue-container-number-23-0">Issue 23</a><span style="text-transform: none">: Explore and resolve `simple` loop editor's notes</span></li><li><a href="#issue-container-number-15-0">Issue 15</a><span style="text-transform: none">: Normalize literals?</span></li><li><a href="#issue-container-number-16">Issue 16</a><span style="text-transform: none">: Optionally fail on duplicates in Hash N-Degree Quads?</span></li><li><a href="#issue-container-number-19">Issue 19</a><span style="text-transform: none">: Add history of the development of the c14n work</span></li></ul></section>

<section id="ack" class="appendix informative"><div class="header-wrapper"><h2 id="c-acknowledgements"><bdi class="secno">C. </bdi>Acknowledgements</h2><a class="self-link" href="#ack" aria-label="Permalink for Appendix C."></a></div><p><em>This section is non-normative.</em></p>
  

  <p>The editors would like to thank Jeremy Carroll for his work on the
    graph canonicalization problem, Gavin Carothers for providing valuable
    feedback and testing input for the algorithm defined in this
    specification, Sir Tim Berners Lee for his thoughts on graph canonicalization
    over the years, Jesús Arias Fisteus for his work on a similar
    algorithm.</p>

  <div class="note" id="issue-container-generatedID-14"><div role="heading" class="ednote-title marker" id="h-ednote-13" aria-level="3"><span>Editor's note</span></div><p class="">Acknowledge CCG and RCH WG. Consider using <code>.publ_ack.json</code>.</p></div>
        <div class="issue" id="issue-container-number-19"><div role="heading" class="issue-title marker" id="h-issue-11" aria-level="3"><a href="https://github.com/w3c/rdf-canon/issues/19"><span class="issue-number">Issue 19</span></a><span class="issue-label">: Add history of the development of the c14n work</span></div><p dir="auto">It's important for both patent and person credit reasons to include the full history.</p>
<p dir="auto">Manu has offered to do this.</p></div>
</section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="d-references"><bdi class="secno">D. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix D."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix D.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-n-quads">[N-Quads]</dt><dd>
      <a href="https://www.w3.org/TR/n-quads/"><cite>RDF 1.1 N-Quads</cite></a>. Gavin Carothers.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/n-quads/">https://www.w3.org/TR/n-quads/</a>
    </dd><dt id="bib-rdf11-concepts">[RDF11-CONCEPTS]</dt><dd>
      <a href="https://www.w3.org/TR/rdf11-concepts/"><cite>RDF 1.1 Concepts and Abstract Syntax</cite></a>. Richard Cyganiak; David Wood; Markus Lanthaler.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-concepts/">https://www.w3.org/TR/rdf11-concepts/</a>
    </dd><dt id="bib-rdf11-mt">[RDF11-MT]</dt><dd>
      <a href="https://www.w3.org/TR/rdf11-mt/"><cite>RDF 1.1 Semantics</cite></a>. Patrick Hayes; Peter Patel-Schneider.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-mt/">https://www.w3.org/TR/rdf11-mt/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc3987">[RFC3987]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3987"><cite>Internationalized Resource Identifiers (IRIs)</cite></a>. M. Duerst; M. Suignard.  IETF. January 2005. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3987">https://www.rfc-editor.org/rfc/rfc3987</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-unicode">[UNICODE]</dt><dd>
      <a href="https://www.unicode.org/versions/latest/"><cite>The Unicode Standard</cite></a>.  Unicode Consortium. URL: <a href="https://www.unicode.org/versions/latest/">https://www.unicode.org/versions/latest/</a>
    </dd><dt id="bib-xpath-functions">[XPATH-FUNCTIONS]</dt><dd>
      <a href="https://www.w3.org/TR/xpath-functions/"><cite>XQuery 1.0 and XPath 2.0 Functions and Operators (Second Edition)</cite></a>. Ashok Malhotra; Jim Melton; Norman Walsh; Michael Kay.  W3C. 14 December 2010. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xpath-functions/">https://www.w3.org/TR/xpath-functions/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="d-2-informative-references"><bdi class="secno">D.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix D.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-ccg-rdc-final">[CCG-RDC-FINAL]</dt><dd>
      <a href="https://www.w3.org/community/reports/credentials/CG-FINAL-rdf-dataset-canonicalization-20221009/"><cite>RDF Dataset Canonicalization</cite></a>. Dave Longley.  W3C. 2022-10-09. CG-FINAL. URL: <a href="https://www.w3.org/community/reports/credentials/CG-FINAL-rdf-dataset-canonicalization-20221009/">https://www.w3.org/community/reports/credentials/CG-FINAL-rdf-dataset-canonicalization-20221009/</a>
    </dd><dt id="bib-designissues-diff">[DesignIssues-Diff]</dt><dd>
      <a href="https://www.w3.org/DesignIssues/Diff"><cite>Delta: an ontology for the distribution of differences between RDF graphs</cite></a>. Tim Berners-Leee.  W3C. 2015-09-25. unofficial. URL: <a href="https://www.w3.org/DesignIssues/Diff">https://www.w3.org/DesignIssues/Diff</a>
    </dd><dt id="bib-eswc2014kasten">[eswc2014Kasten]</dt><dd>
      <a href="https://doi.org/10.1007/978-3-319-07443-6_11"><cite>A Framework for Iterative Signing of Graph Data on the Web</cite></a>. Andreas Kasten; Ansgar Scherp; Peter Schauß .  ISWC 2014. 2014. unofficial. URL: <a href="https://doi.org/10.1007/978-3-319-07443-6_11">https://doi.org/10.1007/978-3-319-07443-6_11</a>
    </dd><dt id="bib-hogan-canonical-rdf">[Hogan-Canonical-RDF]</dt><dd>
      <a href="https://aidanhogan.com/docs/rdf-canonicalisation.pdf"><cite>Canonical Forms for Isomorphic and Equivalent RDF Graphs: Algorithms for Leaning and Labelling Blank Nodes</cite></a>. Aiden Hogan.  ACM Transactions on the Web. 2017-07-17. unofficial. URL: <a href="https://aidanhogan.com/docs/rdf-canonicalisation.pdf">https://aidanhogan.com/docs/rdf-canonicalisation.pdf</a>
    </dd><dt id="bib-hpl-2003-142">[HPL-2003-142]</dt><dd>
      <a href="https://www.hpl.hp.com/techreports/2003/HPL-2003-142.pdf"><cite>Signing RDF Graphs</cite></a>. Jeremy J. Carroll.  HP Laboratories Bristol. 2003-07-23. unofficial. URL: <a href="https://www.hpl.hp.com/techreports/2003/HPL-2003-142.pdf">https://www.hpl.hp.com/techreports/2003/HPL-2003-142.pdf</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-graph-isomorphism" aria-label="Links in this document to definition: graph isomorphism">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-graph-isomorphism" aria-label="Permalink for definition: graph isomorphism. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-graph-isomorphism-1" title="§ 4.9.1 Overview">§ 4.9.1 Overview</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-definition" aria-label="Links in this document to definition: definition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-definition" aria-label="Permalink for definition: definition. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-definition-1" title="§ 1.3 Typographical conventions">§ 1.3 Typographical conventions</a> <a href="#ref-for-dfn-definition-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-string" aria-label="Links in this document to definition: string">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-string" aria-label="Permalink for definition: string. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-string-1" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-string-2" title="§ 4.8.2 Algorithm">§ 4.8.2 Algorithm</a> <a href="#ref-for-dfn-string-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-string-4" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-string-5" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-internationalized-resource-identifier" aria-label="Links in this document to definition: IRI">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-internationalized-resource-identifier" aria-label="Permalink for definition: IRI. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-internationalized-resource-identifier-1" title="§ 1.1 Uses of Dataset Canonicalization">§ 1.1 Uses of Dataset Canonicalization</a> 
  </li><li>
    <a href="#ref-for-dfn-internationalized-resource-identifier-2" title="§ 3. Terminology">§ 3. Terminology</a> <a href="#ref-for-dfn-internationalized-resource-identifier-3" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-subject" aria-label="Links in this document to definition: subject">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-subject" aria-label="Permalink for definition: subject. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-subject-1" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-subject-2" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-subject-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-subject-4" title="§ A. URGNA2012">§ A. URGNA2012</a> <a href="#ref-for-dfn-subject-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-subject-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-subject-7" title="Reference 4">(4)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-predicate" aria-label="Links in this document to definition: predicate">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-predicate" aria-label="Permalink for definition: predicate. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-predicate-1" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-predicate-2" title="§ 4.8.2 Algorithm">§ 4.8.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-predicate-3" title="§ A. URGNA2012">§ A. URGNA2012</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-object" aria-label="Links in this document to definition: object">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-object" aria-label="Permalink for definition: object. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-object-1" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-object-2" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-object-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-object-4" title="§ A. URGNA2012">§ A. URGNA2012</a> <a href="#ref-for-dfn-object-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-object-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-object-7" title="Reference 4">(4)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-rdf-triple" aria-label="Links in this document to definition: RDF triple">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-rdf-triple" aria-label="Permalink for definition: RDF triple. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-rdf-triple-1" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-triple-2" title="§ 4.5.1 Overview">§ 4.5.1 Overview</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-rdf-graph" aria-label="Links in this document to definition: RDF graph">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-rdf-graph" aria-label="Permalink for definition: RDF graph. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-rdf-graph-1" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-graph-name" aria-label="Links in this document to definition: graph name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-graph-name" aria-label="Permalink for definition: graph name. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-graph-name-1" title="§ 3. Terminology">§ 3. Terminology</a> <a href="#ref-for-dfn-graph-name-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-graph-name-3" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-graph-name-4" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-graph-name-5" title="§ A. URGNA2012">§ A. URGNA2012</a> <a href="#ref-for-dfn-graph-name-6" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-default-graph" aria-label="Links in this document to definition: default graph">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-default-graph" aria-label="Permalink for definition: default graph. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-default-graph-1" title="§ 4.5.1 Overview">§ 4.5.1 Overview</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-quad" aria-label="Links in this document to definition: quad">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-quad" aria-label="Permalink for definition: quad. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-quad-1" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-2" title="§ 4.2 Canonicalization Algorithm Terms">§ 4.2 Canonicalization Algorithm Terms</a> <a href="#ref-for-dfn-quad-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-4" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-5" title="§ 4.5.1 Overview">§ 4.5.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-6" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-quad-7" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-8" title="§ 4.7 Hash First Degree Quads">§ 4.7 Hash First Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-9" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> <a href="#ref-for-dfn-quad-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-quad-11" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-12" title="§ 4.9 Hash N-Degree Quads">§ 4.9 Hash N-Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-13" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-quad-14" title="§ A. URGNA2012">§ A. URGNA2012</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-rdf-dataset" aria-label="Links in this document to definition: RDF dataset">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-rdf-dataset" aria-label="Permalink for definition: RDF dataset. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-rdf-dataset-1" title="§ Abstract">§ Abstract</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-dataset-2" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-rdf-dataset-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-rdf-dataset-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-rdf-dataset-5" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-dataset-6" title="§ 1.2 How to Read this Document">§ 1.2 How to Read this Document</a> <a href="#ref-for-dfn-rdf-dataset-7" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-dataset-8" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-dataset-9" title="§ 4.2 Canonicalization Algorithm Terms">§ 4.2 Canonicalization Algorithm Terms</a> <a href="#ref-for-dfn-rdf-dataset-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-rdf-dataset-11" title="Reference 3">(3)</a> <a href="#ref-for-dfn-rdf-dataset-12" title="Reference 4">(4)</a> <a href="#ref-for-dfn-rdf-dataset-13" title="Reference 5">(5)</a> <a href="#ref-for-dfn-rdf-dataset-14" title="Reference 6">(6)</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-dataset-15" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-dataset-16" title="§ 4.5.1 Overview">§ 4.5.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-dataset-17" title="§ 4.7 Hash First Degree Quads">§ 4.7 Hash First Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-rdf-dataset-18" title="§ 4.9 Hash N-Degree Quads">§ 4.9 Hash N-Degree Quads</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-blank-node" aria-label="Links in this document to definition: blank node">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-blank-node" aria-label="Permalink for definition: blank node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-blank-node-1" title="§ 1.1 Uses of Dataset Canonicalization">§ 1.1 Uses of Dataset Canonicalization</a> <a href="#ref-for-dfn-blank-node-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-blank-node-4" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-5" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-6" title="§ 4.2 Canonicalization Algorithm Terms">§ 4.2 Canonicalization Algorithm Terms</a> <a href="#ref-for-dfn-blank-node-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-8" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-9" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-10" title="§ 4.4 Blank Node Identifier Issuer State">§ 4.4 Blank Node Identifier Issuer State</a> <a href="#ref-for-dfn-blank-node-11" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-12" title="§ 4.5 Canonicalization Algorithm">§ 4.5 Canonicalization Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-13" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-blank-node-14" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-15" title="§ 4.7 Hash First Degree Quads">§ 4.7 Hash First Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-16" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> <a href="#ref-for-dfn-blank-node-17" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-18" title="§ 4.8.2 Algorithm">§ 4.8.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-19" title="§ 4.9 Hash N-Degree Quads">§ 4.9 Hash N-Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-20" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-blank-node-21" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-22" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-23" title="§ A. URGNA2012">§ A. URGNA2012</a> <a href="#ref-for-dfn-blank-node-24" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-blank-node-identifier" aria-label="Links in this document to definition: blank node identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-blank-node-identifier" aria-label="Permalink for definition: blank node identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-blank-node-identifier-1" title="§ 1.1 Uses of Dataset Canonicalization">§ 1.1 Uses of Dataset Canonicalization</a> <a href="#ref-for-dfn-blank-node-identifier-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-blank-node-identifier-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-blank-node-identifier-5" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-6" title="§ 3. Terminology">§ 3. Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-7" title="§ 4.2 Canonicalization Algorithm Terms">§ 4.2 Canonicalization Algorithm Terms</a> <a href="#ref-for-dfn-blank-node-identifier-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-blank-node-identifier-10" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-11" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> <a href="#ref-for-dfn-blank-node-identifier-12" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-13" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-14" title="§ 4.4 Blank Node Identifier Issuer State">§ 4.4 Blank Node Identifier Issuer State</a> <a href="#ref-for-dfn-blank-node-identifier-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-16" title="Reference 3">(3)</a> <a href="#ref-for-dfn-blank-node-identifier-17" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-18" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-blank-node-identifier-19" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-20" title="Reference 3">(3)</a> <a href="#ref-for-dfn-blank-node-identifier-21" title="Reference 4">(4)</a> <a href="#ref-for-dfn-blank-node-identifier-22" title="Reference 5">(5)</a> <a href="#ref-for-dfn-blank-node-identifier-23" title="Reference 6">(6)</a> <a href="#ref-for-dfn-blank-node-identifier-24" title="Reference 7">(7)</a> <a href="#ref-for-dfn-blank-node-identifier-25" title="Reference 8">(8)</a> <a href="#ref-for-dfn-blank-node-identifier-26" title="Reference 9">(9)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-27" title="§ 4.6.1 Algorithm">§ 4.6.1 Algorithm</a> <a href="#ref-for-dfn-blank-node-identifier-28" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-29" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-30" title="§ 4.7.1 Overview">§ 4.7.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-31" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> <a href="#ref-for-dfn-blank-node-identifier-32" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-33" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-34" title="§ 4.8.2 Algorithm">§ 4.8.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-35" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-blank-node-identifier-36" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-37" title="Reference 3">(3)</a> <a href="#ref-for-dfn-blank-node-identifier-38" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-identifier-39" title="§ A. URGNA2012">§ A. URGNA2012</a> <a href="#ref-for-dfn-blank-node-identifier-40" title="Reference 2">(2)</a> <a href="#ref-for-dfn-blank-node-identifier-41" title="Reference 3">(3)</a> <a href="#ref-for-dfn-blank-node-identifier-42" title="Reference 4">(4)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-urdna2015" aria-label="Links in this document to definition: URDNA2015">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-urdna2015" aria-label="Permalink for definition: URDNA2015. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-urdna2015-1" title="§ Status of This Document">§ Status of This Document</a> 
  </li><li>
    <a href="#ref-for-dfn-urdna2015-2" title="§ 1. Introduction">§ 1. Introduction</a> 
  </li><li>
    <a href="#ref-for-dfn-urdna2015-3" title="§ 4.1 Overview">§ 4.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-urdna2015-4" title="§ 4.2 Canonicalization Algorithm Terms">§ 4.2 Canonicalization Algorithm Terms</a> 
  </li><li>
    <a href="#ref-for-dfn-urdna2015-5" title="§ 4.5.1 Overview">§ 4.5.1 Overview</a> <a href="#ref-for-dfn-urdna2015-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-urdna2015-7" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-input-dataset" aria-label="Links in this document to definition: input dataset">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-input-dataset" aria-label="Permalink for definition: input dataset. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-input-dataset-1" title="§ 4. Canonicalization">§ 4. Canonicalization</a> <a href="#ref-for-dfn-input-dataset-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-input-dataset-3" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> 
  </li><li>
    <a href="#ref-for-dfn-input-dataset-4" title="§ 4.5 Canonicalization Algorithm">§ 4.5 Canonicalization Algorithm</a> <a href="#ref-for-dfn-input-dataset-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-input-dataset-6" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-input-dataset-7" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-input-dataset-8" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-normalized-dataset" aria-label="Links in this document to definition: normalized dataset">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-normalized-dataset" aria-label="Permalink for definition: normalized dataset. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-normalized-dataset-1" title="§ 1.1 Uses of Dataset Canonicalization">§ 1.1 Uses of Dataset Canonicalization</a> 
  </li><li>
    <a href="#ref-for-dfn-normalized-dataset-2" title="§ 4. Canonicalization">§ 4. Canonicalization</a> <a href="#ref-for-dfn-normalized-dataset-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-normalized-dataset-4" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-normalized-dataset-5" title="§ 4.2 Canonicalization Algorithm Terms">§ 4.2 Canonicalization Algorithm Terms</a> <a href="#ref-for-dfn-normalized-dataset-6" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-normalized-dataset-7" title="§ 4.5 Canonicalization Algorithm">§ 4.5 Canonicalization Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-normalized-dataset-8" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-normalized-dataset-9" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-identifier-issuer" aria-label="Links in this document to definition: identifier issuer">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-identifier-issuer" aria-label="Permalink for definition: identifier issuer. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-identifier-issuer-1" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> 
  </li><li>
    <a href="#ref-for-dfn-identifier-issuer-2" title="§ 4.4 Blank Node Identifier Issuer State">§ 4.4 Blank Node Identifier Issuer State</a> <a href="#ref-for-dfn-identifier-issuer-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-identifier-issuer-4" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-identifier-issuer-5" title="§ 4.6.1 Algorithm">§ 4.6.1 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-identifier-issuer-6" title="§ 4.8.2 Algorithm">§ 4.8.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-identifier-issuer-7" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-identifier-issuer-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-identifier-issuer-9" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-hash" aria-label="Links in this document to definition: hash">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-hash" aria-label="Permalink for definition: hash. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-hash-1" title="§ 4.1 Overview">§ 4.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-2" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> <a href="#ref-for-dfn-hash-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-hash-4" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-5" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-6" title="§ 4.7 Hash First Degree Quads">§ 4.7 Hash First Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-7" title="§ 4.7.1 Overview">§ 4.7.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-8" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-9" title="§ 4.8.2 Algorithm">§ 4.8.2 Algorithm</a> <a href="#ref-for-dfn-hash-10" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-11" title="§ 4.9 Hash N-Degree Quads">§ 4.9 Hash N-Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-12" title="§ 4.9.1 Overview">§ 4.9.1 Overview</a> <a href="#ref-for-dfn-hash-13" title="Reference 2">(2)</a> <a href="#ref-for-dfn-hash-14" title="Reference 3">(3)</a> <a href="#ref-for-dfn-hash-15" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-16" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-hash-17" title="Reference 2">(2)</a> <a href="#ref-for-dfn-hash-18" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-hash-algorithm" aria-label="Links in this document to definition: hash algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-hash-algorithm" aria-label="Permalink for definition: hash algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-hash-algorithm-1" title="§ 4.7.2 Examples">§ 4.7.2 Examples</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-algorithm-2" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-algorithm-3" title="§ 4.8.2 Algorithm">§ 4.8.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-hash-algorithm-4" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-code-point-order" aria-label="Links in this document to definition: Unicode point order">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-code-point-order" aria-label="Permalink for definition: Unicode point order. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-code-point-order-1" title="§ 4.5.1 Overview">§ 4.5.1 Overview</a> <a href="#ref-for-dfn-code-point-order-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-code-point-order-3" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-code-point-order-4" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-code-point-order-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-code-point-order-6" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-code-point-order-7" title="§ 4.7.1 Overview">§ 4.7.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-code-point-order-8" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-code-point-order-9" title="§ 4.9.1 Overview">§ 4.9.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-code-point-order-10" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> <a href="#ref-for-dfn-code-point-order-11" title="Reference 2">(2)</a> <a href="#ref-for-dfn-code-point-order-12" title="Reference 3">(3)</a> <a href="#ref-for-dfn-code-point-order-13" title="Reference 4">(4)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-mention" aria-label="Links in this document to definition: mention set">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-mention" aria-label="Permalink for definition: mention set. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-mention-1" title="§ 4.2 Canonicalization Algorithm Terms">§ 4.2 Canonicalization Algorithm Terms</a> 
  </li><li>
    <a href="#ref-for-dfn-mention-2" title="§ 4.7.1 Overview">§ 4.7.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-mention-3" title="§ 4.9 Hash N-Degree Quads">§ 4.9 Hash N-Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-mention-4" title="§ 4.9.1 Overview">§ 4.9.1 Overview</a> <a href="#ref-for-dfn-mention-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-mention-6" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-gossip-path" aria-label="Links in this document to definition: gossip path">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-gossip-path" aria-label="Permalink for definition: gossip path. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-gossip-path-1" title="§ 4.9 Hash N-Degree Quads">§ 4.9 Hash N-Degree Quads</a> 
  </li><li>
    <a href="#ref-for-dfn-gossip-path-2" title="§ 4.9.1 Overview">§ 4.9.1 Overview</a> <a href="#ref-for-dfn-gossip-path-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-gossip-path-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-gossip-path-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-gossip-path-6" title="Reference 5">(5)</a> <a href="#ref-for-dfn-gossip-path-7" title="Reference 6">(6)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-canonicalization-state" aria-label="Links in this document to definition: canonicalization state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-canonicalization-state" aria-label="Permalink for definition: canonicalization state. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-canonicalization-state-1" title="§ 4.3 Canonicalization State">§ 4.3 Canonicalization State</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-state-2" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-state-3" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-state-4" title="§ 4.8.2 Algorithm">§ 4.8.2 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-state-5" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-blank-node-to-quads-map" aria-label="Links in this document to definition: blank node to quads map">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-blank-node-to-quads-map" aria-label="Permalink for definition: blank node to quads map. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-blank-node-to-quads-map-1" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-blank-node-to-quads-map-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-to-quads-map-3" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-blank-node-to-quads-map-4" title="§ 4.9.3 Algorithm">§ 4.9.3 Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-hash-to-blank-nodes-map" aria-label="Links in this document to definition: hash to blank nodes map">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-hash-to-blank-nodes-map" aria-label="Permalink for definition: hash to blank nodes map. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-hash-to-blank-nodes-map-1" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-hash-to-blank-nodes-map-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-hash-to-blank-nodes-map-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-hash-to-blank-nodes-map-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-hash-to-blank-nodes-map-5" title="Reference 5">(5)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-canonical-issuer" aria-label="Links in this document to definition: canonical issuer">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-canonical-issuer" aria-label="Permalink for definition: canonical issuer. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-canonical-issuer-1" title="§ 4.5.2 Algorithm">§ 4.5.2 Algorithm</a> <a href="#ref-for-dfn-canonical-issuer-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-canonical-issuer-3" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-identifier-prefix" aria-label="Links in this document to definition: identifier prefix">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-identifier-prefix" aria-label="Permalink for definition: identifier prefix. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-identifier-prefix-1" title="§ 4.4 Blank Node Identifier Issuer State">§ 4.4 Blank Node Identifier Issuer State</a> <a href="#ref-for-dfn-identifier-prefix-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-identifier-prefix-3" title="§ 4.6.1 Algorithm">§ 4.6.1 Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-identifier-counter" aria-label="Links in this document to definition: identifier counter">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-identifier-counter" aria-label="Permalink for definition: identifier counter. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-identifier-counter-1" title="§ 4.4 Blank Node Identifier Issuer State">§ 4.4 Blank Node Identifier Issuer State</a> 
  </li><li>
    <a href="#ref-for-dfn-identifier-counter-2" title="§ 4.6.1 Algorithm">§ 4.6.1 Algorithm</a> <a href="#ref-for-dfn-identifier-counter-3" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-issued-identifiers-list" aria-label="Links in this document to definition: issued identifiers list">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-issued-identifiers-list" aria-label="Permalink for definition: issued identifiers list. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-issued-identifiers-list-1" title="§ 4.6.1 Algorithm">§ 4.6.1 Algorithm</a> <a href="#ref-for-dfn-issued-identifiers-list-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-reference-blank-node-identifier" aria-label="Links in this document to definition: reference blank node identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-reference-blank-node-identifier" aria-label="Permalink for definition: reference blank node identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-reference-blank-node-identifier-1" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> <a href="#ref-for-dfn-reference-blank-node-identifier-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-nquads" aria-label="Links in this document to definition: nquads">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-nquads" aria-label="Permalink for definition: nquads. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-nquads-1" title="§ 4.7.3 Algorithm">§ 4.7.3 Algorithm</a> <a href="#ref-for-dfn-nquads-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-urgna2012" aria-label="Links in this document to definition: URGNA2012">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-urgna2012" aria-label="Permalink for definition: URGNA2012. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-urgna2012-1" title="§ A. URGNA2012">§ A. URGNA2012</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>